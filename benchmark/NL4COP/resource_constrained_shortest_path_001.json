{
  "problem_id": "resource_constrained_shortest_path_001",
  "metadata": {
    "problem_type": "Resource Constrained Shortest Path Problem",
    "difficulty": "simple"
  },
  "problem_description": "A sophisticated intelligent supply chain management framework requires optimizing autonomous material flow trajectories across a distributed logistics network to establish optimal delivery pathways that minimize comprehensive transportation expenditure while conforming to stringent energy utilization parameters and temporal operational constraints. The system must select a route containing exactly four facilities including the starting point and destination. Advanced resource allocation protocols govern power consumption capped at fifty kilowatt-hours and operational duration limited to thirty hours through strategic route planning that balances delivery efficiency against sustainable resource utilization patterns. Node-specific resource consumption profiles include: distribution hub zero kilowatt-hours zero hours, processing station alpha two kilowatt-hours one hour, processing station beta one kilowatt-hour three hours, processing station gamma three kilowatt-hours two hours, processing station delta two kilowatt-hours one hour, processing station epsilon one kilowatt-hour two hours, processing station zeta four kilowatt-hours one hour, processing station eta two kilowatt-hours three hours, relay station zero kilowatt-hours zero hours, and strategic fulfillment center zero kilowatt-hours zero hours. Available transportation corridors include: from distribution hub to processing station alpha cost ten dollars three kilowatt-hours two hours, to processing station beta cost fifteen dollars two kilowatt-hours three hours, to processing station gamma cost twenty dollars four kilowatt-hours one hour, from processing station alpha to processing station delta cost thirteen dollars two kilowatt-hours two hours, to processing station epsilon cost eighteen dollars three kilowatt-hours one hour, from processing station beta to processing station delta cost eight dollars one kilowatt-hour three hours, to processing station zeta cost fourteen dollars two kilowatt-hours two hours, from processing station gamma to processing station epsilon cost ten dollars two kilowatt-hours one hour, to processing station eta cost sixteen dollars three kilowatt-hours two hours, from processing station delta to relay station cost fifteen dollars two kilowatt-hours one hour, to strategic fulfillment center cost four dollars two kilowatt-hours one hour, from processing station epsilon to relay station cost twelve dollars one kilowatt-hour two hours, from processing station zeta to relay station cost ten dollars one kilowatt-hour one hour, from processing station eta to relay station cost eight dollars two kilowatt-hours one hour.",
  "solution_format_description": "Print the following fields: - trajectory: sequence of facilities visited from start to end. - total_cost: total transportation cost. - resource_consumption: total energy and time used.",  
  "structured_data": {
    "resource_constraints": [50, 30],
    "facility_resource_consumption": [
      [0, 0], [2, 1], [1, 3], [3, 2], [2, 1],
      [1, 2], [4, 1], [2, 3], [0, 0], [0, 0]
    ],
    "transportation_network": [
      [0, 1, 10, 3, 2], [0, 2, 15, 2, 3], [0, 3, 20, 4, 1],
      [1, 4, 13, 2, 2], [1, 5, 18, 3, 1],
      [2, 4, 8, 1, 3], [2, 6, 14, 2, 2],
      [3, 5, 10, 2, 1], [3, 7, 16, 3, 2],
      [4, 8, 15, 2, 1], [4, 9, 4, 2, 1],
      [5, 8, 12, 1, 2],
      [6, 8, 10, 1, 1],
      [7, 8, 8, 2, 1]
    ]
  },
  "reference_solution": {
    "trajectory": [
      0,
      1,
      4,
      9
    ],
    "total_cost": 27,
    "resource_consumption": [11, 7]
  },
  "solver_code": "from cpmpy import *\nimport json\n\nresource_constraints = [50, 30]\nfacility_resource_consumption = [\n    [0, 0], [2, 1], [1, 3], [3, 2], [2, 1],\n    [1, 2], [4, 1], [2, 3], [0, 0], [0, 0]\n]\ntransportation_network = [\n    [0, 1, 10, 3, 2], [0, 2, 15, 2, 3], [0, 3, 20, 4, 1],\n    [1, 4, 13, 2, 2], [1, 5, 18, 3, 1],\n    [2, 4, 8, 1, 3], [2, 6, 14, 2, 2],\n    [3, 5, 10, 2, 1], [3, 7, 16, 3, 2],\n    [4, 8, 15, 2, 1], [4, 9, 4, 2, 1],\n    [5, 8, 12, 1, 2],\n    [6, 8, 10, 1, 1],\n    [7, 8, 8, 2, 1]\n]\n\nmodel = Model()\n\npath_length = 4\npath = intvar(0, 9, shape=path_length)\n\nmodel += path[0] == 0\nmodel += path[path_length-1] == 9\n\nfor i in range(path_length-1):\n    valid_edges = []\n    for route in transportation_network:\n        start, dest, cost, energy, temporal = route\n        valid_edges.append((path[i] == start) & (path[i+1] == dest))\n    model += any(valid_edges)\n\ntotal_energy = intvar(0, resource_constraints[0])\ntotal_temporal = intvar(0, resource_constraints[1])\n\nenergy_expr = 0\ntemporal_expr = 0\n\nfor i in range(path_length):\n    for loc in range(10):\n        energy_expr += (path[i] == loc) * facility_resource_consumption[loc][0]\n        temporal_expr += (path[i] == loc) * facility_resource_consumption[loc][1]\n\nfor i in range(path_length-1):\n    for route in transportation_network:\n        start, dest, cost, energy, temporal = route\n        energy_expr += ((path[i] == start) & (path[i+1] == dest)) * energy\n        temporal_expr += ((path[i] == start) & (path[i+1] == dest)) * temporal\n\nmodel += total_energy == energy_expr\nmodel += total_temporal == temporal_expr\n\nmodel += total_energy <= resource_constraints[0]\nmodel += total_temporal <= resource_constraints[1]\n\ntotal_cost = 0\nfor i in range(path_length-1):\n    for route in transportation_network:\n        start, dest, cost, energy, temporal = route\n        total_cost += ((path[i] == start) & (path[i+1] == dest)) * cost\n\nmodel.minimize(total_cost)\n\nif model.solve():\n    trajectory = [path[i].value() for i in range(path_length)]\n    \n    result = {\n        \"trajectory\": trajectory,\n        \"total_cost\": total_cost.value(),\n        \"resource_consumption\": [total_energy.value(), total_temporal.value()]\n    }\n    \n    print(json.dumps(result))\nelse:\n    print(json.dumps({\"trajectory\": [], \"total_cost\": -1, \"resource_consumption\": [0, 0]}))",
  "evaluation_function": "def evaluate(candidate_solution, structured_data, reference_solution):\n    import json\n    \n    try:\n        solution = json.loads(candidate_solution) if isinstance(candidate_solution, str) else candidate_solution\n    except:\n        return {\"is_valid\": False, \"validation_errors\": [\"Invalid JSON format\"], \"optimality_score\": 0.0}\n    \n    required_fields = [\"trajectory\", \"total_cost\", \"resource_consumption\"]\n    missing = [f for f in required_fields if solution is None or f not in solution]\n    if missing:\n        return {\"is_valid\": False, \"validation_errors\": [f\"Missing fields: {missing}\"], \"optimality_score\": 0.0}\n    \n    try:\n        trajectory = solution[\"trajectory\"]\n        total_cost = solution[\"total_cost\"]\n        resource_consumption = solution[\"resource_consumption\"]\n        \n        resource_constraints = structured_data[\"resource_constraints\"]\n        facility_resource_consumption = structured_data[\"facility_resource_consumption\"]\n        transportation_network = structured_data[\"transportation_network\"]\n        \n        errors = []\n        \n        if len(trajectory) != 4:\n            errors.append(f\"Trajectory must have exactly 4 facilities, got {len(trajectory)}\")\n        \n        if trajectory[0] != 0:\n            errors.append(\"Trajectory must start at facility 0 (hub)\")\n        \n        if trajectory[-1] != 9:\n            errors.append(\"Trajectory must end at facility 9 (center)\")\n        \n        num_facilities = len(facility_resource_consumption)\n        for facility in trajectory:\n            if facility < 0 or facility >= num_facilities:\n                errors.append(f\"Invalid facility {facility} in trajectory\")\n        \n        for i in range(len(trajectory) - 1):\n            current = trajectory[i]\n            next_facility = trajectory[i + 1]\n            \n            valid_transition = False\n            for route in transportation_network:\n                start, dest, cost, energy, temporal = route\n                if start == current and dest == next_facility:\n                    valid_transition = True\n                    break\n            \n            if not valid_transition:\n                errors.append(f\"No valid route from facility {current} to facility {next_facility}\")\n        \n        calculated_energy = 0\n        calculated_temporal = 0\n        \n        for facility in trajectory:\n            calculated_energy += facility_resource_consumption[facility][0]\n            calculated_temporal += facility_resource_consumption[facility][1]\n        \n        for i in range(len(trajectory) - 1):\n            current = trajectory[i]\n            next_facility = trajectory[i + 1]\n            \n            for route in transportation_network:\n                start, dest, cost, energy, temporal = route\n                if start == current and dest == next_facility:\n                    calculated_energy += energy\n                    calculated_temporal += temporal\n                    break\n        \n        max_energy, max_temporal = resource_constraints\n        \n        if calculated_energy > max_energy:\n            errors.append(f\"Energy consumption {calculated_energy} exceeds maximum {max_energy}\")\n        \n        if calculated_temporal > max_temporal:\n            errors.append(f\"Temporal allocation {calculated_temporal} exceeds maximum {max_temporal}\")\n        \n        if len(resource_consumption) != 2:\n            errors.append(\"Resource consumption must have exactly 2 values [energy, temporal]\")\n        else:\n            declared_energy = resource_consumption[0]\n            declared_temporal = resource_consumption[1]\n            \n            if abs(calculated_energy - declared_energy) > 1e-6:\n                errors.append(f\"Energy inconsistency: calculated {calculated_energy}, declared {declared_energy}\")\n            \n            if abs(calculated_temporal - declared_temporal) > 1e-6:\n                errors.append(f\"Temporal inconsistency: calculated {calculated_temporal}, declared {declared_temporal}\")\n        \n        if len(errors) > 0:\n            return {\n                \"is_valid\": False,\n                \"validation_errors\": errors,\n                \"optimality_score\": 0.0\n            }\n        \n        optimal_cost = reference_solution[\"total_cost\"]\n        if optimal_cost == 0:\n            optimality_score = 1.0 if total_cost == 0 else 0.0\n        else:\n            gap = abs(optimal_cost - total_cost) / abs(optimal_cost)\n            optimality_score = max(0, 1 - gap)\n            \n        return {\n            \"is_valid\": True,\n            \"validation_errors\": [],\n            \"optimality_score\": optimality_score\n        }\n        \n    except Exception as e:\n        return {\"is_valid\": False, \"validation_errors\": [\"Format error in solution data\"], \"optimality_score\": 0.0}"
}
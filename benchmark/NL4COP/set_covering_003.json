{
  "problem_id": "set_covering_003",
  "metadata": {
    "problem_type": "Set Covering Problem",
    "difficulty": "hard"
  },
  "problem_description": "An advanced industrial automation optimization initiative requires strategic equipment procurement to address 20 distinct functional requirements across a sophisticated manufacturing ecosystem. The procurement evaluation framework has identified 50 potential equipment options, each characterized by specific purchasing costs and distinctive operational capability matrices. Equipment configuration specifications are as follows: Equipment Type 1 requires purchasing costs of 800 yuan with operational capabilities for functional requirements 6, 8, 10, 16, 19; Equipment Type 2 requires purchasing costs of 840 yuan with operational capabilities for functional requirements 13, 15, 18; Equipment Type 3 requires purchasing costs of 810 yuan with operational capabilities for functional requirements 1, 2, 5, 15; Equipment Type 4 requires purchasing costs of 860 yuan with operational capabilities for functional requirements 1, 9, 12; Equipment Type 5 requires purchasing costs of 840 yuan with operational capabilities for functional requirements 1, 4, 9, 14, 19; Equipment Type 6 requires purchasing costs of 810 yuan with operational capabilities for functional requirements 3, 12, 17, 19, 20; Equipment Type 7 requires purchasing costs of 800 yuan with operational capabilities for functional requirements 1, 3, 13, 18; Equipment Type 8 requires purchasing costs of 1020 yuan with operational capabilities for functional requirements 1, 9, 11, 13, 16, 19; Equipment Type 9 requires purchasing costs of 1070 yuan with operational capabilities for functional requirements 1, 6, 11, 12, 14, 15; Equipment Type 10 requires purchasing costs of 1070 yuan with operational capabilities for functional requirements 3, 5, 8, 12, 20; Equipment Type 11 requires purchasing costs of 1000 yuan with operational capabilities for functional requirements 2, 5, 10, 13, 15, 17; Equipment Type 12 requires purchasing costs of 1000 yuan with operational capabilities for functional requirements 5, 9, 10, 11, 12, 13; Equipment Type 13 requires purchasing costs of 910 yuan with operational capabilities for functional requirements 6, 13, 14, 19; Equipment Type 14 requires purchasing costs of 950 yuan with operational capabilities for functional requirements 1, 5, 12, 15; Equipment Type 15 requires purchasing costs of 940 yuan with operational capabilities for functional requirements 1, 6, 10, 14, 15; Equipment Type 16 requires purchasing costs of 1000 yuan with operational capabilities for functional requirements 5, 9, 11, 17, 19, 20; Equipment Type 17 requires purchasing costs of 1070 yuan with operational capabilities for functional requirements 8, 11, 12, 18; Equipment Type 18 requires purchasing costs of 1000 yuan with operational capabilities for functional requirements 7, 8, 9, 17; Equipment Type 19 requires purchasing costs of 970 yuan with operational capabilities for functional requirements 2, 3, 9, 13, 17; Equipment Type 20 requires purchasing costs of 950 yuan with operational capabilities for functional requirements 1, 7, 17, 19; Equipment Type 21 requires purchasing costs of 900 yuan with operational capabilities for functional requirements 3, 8, 11, 18, 19; Equipment Type 22 requires purchasing costs of 1030 yuan with operational capabilities for functional requirements 5, 16, 18, 19, 20; Equipment Type 23 requires purchasing costs of 920 yuan with operational capabilities for functional requirements 1, 9, 11, 13, 16; Equipment Type 24 requires purchasing costs of 1090 yuan with operational capabilities for functional requirements 1, 5, 8, 16, 17; Equipment Type 25 requires purchasing costs of 1020 yuan with operational capabilities for functional requirements 2, 4, 12, 15, 19; Equipment Type 26 requires purchasing costs of 920 yuan with operational capabilities for functional requirements 7, 11, 12, 14, 15; Equipment Type 27 requires purchasing costs of 900 yuan with operational capabilities for functional requirements 2, 6, 7, 13, 14; Equipment Type 28 requires purchasing costs of 1000 yuan with operational capabilities for functional requirements 6, 9, 12, 13, 17; Equipment Type 29 requires purchasing costs of 1040 yuan with operational capabilities for functional requirements 4, 9, 10, 17; Equipment Type 30 requires purchasing costs of 930 yuan with operational capabilities for functional requirements 2, 5, 11, 13, 18, 19; Equipment Type 31 requires purchasing costs of 910 yuan with operational capabilities for functional requirements 8, 11, 15, 19; Equipment Type 32 requires purchasing costs of 920 yuan with operational capabilities for functional requirements 8, 9, 12, 15, 17, 20; Equipment Type 33 requires purchasing costs of 940 yuan with operational capabilities for functional requirements 2, 9, 11, 17, 19; Equipment Type 34 requires purchasing costs of 940 yuan with operational capabilities for functional requirements 1, 4, 14, 16; Equipment Type 35 requires purchasing costs of 900 yuan with operational capabilities for functional requirements 2, 5, 9, 16, 18, 19; Equipment Type 36 requires purchasing costs of 990 yuan with operational capabilities for functional requirements 2, 8, 11, 12; Equipment Type 37 requires purchasing costs of 1030 yuan with operational capabilities for functional requirements 1, 10, 11, 13, 17; Equipment Type 38 requires purchasing costs of 1080 yuan with operational capabilities for functional requirements 3, 6, 9, 10; Equipment Type 39 requires purchasing costs of 1050 yuan with operational capabilities for functional requirements 1, 2, 12, 14, 16; Equipment Type 40 requires purchasing costs of 980 yuan with operational capabilities for functional requirements 2, 6, 7, 9, 13, 20; Equipment Type 41 requires purchasing costs of 1050 yuan with operational capabilities for functional requirements 4, 7, 10, 15, 16, 17; Equipment Type 42 requires purchasing costs of 910 yuan with operational capabilities for functional requirements 3, 4, 9, 15, 17; Equipment Type 43 requires purchasing costs of 990 yuan with operational capabilities for functional requirements 3, 13, 14, 17; Equipment Type 44 requires purchasing costs of 1150 yuan with operational capabilities for functional requirements 2, 3, 4, 8, 12, 14, 15, 18; Equipment Type 45 requires purchasing costs of 1180 yuan with operational capabilities for functional requirements 2, 7, 8, 18, 19, 20; Equipment Type 46 requires purchasing costs of 1170 yuan with operational capabilities for functional requirements 1, 4, 11, 12, 14, 16, 19, 20; Equipment Type 47 requires purchasing costs of 1130 yuan with operational capabilities for functional requirements 4, 6, 10, 11, 15, 18, 19, 20; Equipment Type 48 requires purchasing costs of 1190 yuan with operational capabilities for functional requirements 1, 4, 5, 12, 15, 17; Equipment Type 49 requires purchasing costs of 1200 yuan with operational capabilities for functional requirements 2, 7, 8, 13, 14, 16, 17, 20; Equipment Type 50 requires purchasing costs of 1180 yuan with operational capabilities for functional requirements 4, 5, 10, 16, 19. Each functional requirement must be addressed by the operational capabilities of at least one selected equipment option. Each equipment option can either be procured or not procured, with partial procurement being prohibited. Decision makers must determine optimal equipment selection to achieve complete functional requirement fulfillment while minimizing total purchasing expenditure.",  
  "solution_format_description": "Print the following fields: - selected_equipment: chosen equipment types. - total_equipment_cost: total cost of selected equipment.",
  "structured_data": {
    "num_requirements": 20,
    "num_equipment_types": 50,
    "equipment_costs": [800, 840, 810, 860, 840, 810, 800, 1020, 1070, 1070, 1000, 1000, 910, 950, 940, 1000, 1070, 1000, 970, 950, 900, 1030, 920, 1090, 1020, 920, 900, 1000, 1040, 930, 910, 920, 940, 940, 900, 990, 1030, 1080, 1050, 980, 1050, 910, 990, 1150, 1180, 1170, 1130, 1190, 1200, 1180],
    "equipment_capabilities": [
      [6, 8, 10, 16, 19], [13, 15, 18], [1, 2, 5, 15], [1, 9, 12], [1, 4, 9, 14, 19], [3, 12, 17, 19, 20], [1, 3, 13, 18],
      [1, 9, 11, 13, 16, 19], [1, 6, 11, 12, 14, 15], [3, 5, 8, 12, 20], [2, 5, 10, 13, 15, 17], [5, 9, 10, 11, 12, 13],
      [6, 13, 14, 19], [1, 5, 12, 15], [1, 6, 10, 14, 15], [5, 9, 11, 17, 19, 20], [8, 11, 12, 18], [7, 8, 9, 17],
      [2, 3, 9, 13, 17], [1, 7, 17, 19], [3, 8, 11, 18, 19], [5, 16, 18, 19, 20], [1, 9, 11, 13, 16], [1, 5, 8, 16, 17],
      [2, 4, 12, 15, 19], [7, 11, 12, 14, 15], [2, 6, 7, 13, 14], [6, 9, 12, 13, 17], [4, 9, 10, 17], [2, 5, 11, 13, 18, 19],
      [8, 11, 15, 19], [8, 9, 12, 15, 17, 20], [2, 9, 11, 17, 19], [1, 4, 14, 16], [2, 5, 9, 16, 18, 19], [2, 8, 11, 12],
      [1, 10, 11, 13, 17], [3, 6, 9, 10], [1, 2, 12, 14, 16], [2, 6, 7, 9, 13, 20], [4, 7, 10, 15, 16, 17], [3, 4, 9, 15, 17],
      [3, 13, 14, 17], [2, 3, 4, 8, 12, 14, 15, 18], [2, 7, 8, 18, 19, 20], [1, 4, 11, 12, 14, 16, 19, 20], [4, 6, 10, 11, 15, 18, 19, 20],
      [1, 4, 5, 12, 15, 17], [2, 7, 8, 13, 14, 16, 17, 20], [4, 5, 10, 16, 19]
    ]
  },
  "reference_solution": {
    "selected_equipment": [
      11,
      21,
      40,
      46
    ],
    "total_equipment_cost": 4050
  },
  "solver_code": "from cpmpy import *\nimport json\n\n\nnum_requirements = 20\nnum_equipment_types = 50\nequipment_costs = [800, 840, 810, 860, 840, 810, 800, 1020, 1070, 1070, 1000, 1000, 910, 950, 940, 1000, 1070, 1000, 970, 950, 900, 1030, 920, 1090, 1020, 920, 900, 1000, 1040, 930, 910, 920, 940, 940, 900, 990, 1030, 1080, 1050, 980, 1050, 910, 990, 1150, 1180, 1170, 1130, 1190, 1200, 1180]\nequipment_capabilities = [\n    [6, 8, 10, 16, 19], [13, 15, 18], [1, 2, 5, 15], [1, 9, 12], [1, 4, 9, 14, 19], [3, 12, 17, 19, 20], [1, 3, 13, 18],\n    [1, 9, 11, 13, 16, 19], [1, 6, 11, 12, 14, 15], [3, 5, 8, 12, 20], [2, 5, 10, 13, 15, 17], [5, 9, 10, 11, 12, 13],\n    [6, 13, 14, 19], [1, 5, 12, 15], [1, 6, 10, 14, 15], [5, 9, 11, 17, 19, 20], [8, 11, 12, 18], [7, 8, 9, 17],\n    [2, 3, 9, 13, 17], [1, 7, 17, 19], [3, 8, 11, 18, 19], [5, 16, 18, 19, 20], [1, 9, 11, 13, 16], [1, 5, 8, 16, 17],\n    [2, 4, 12, 15, 19], [7, 11, 12, 14, 15], [2, 6, 7, 13, 14], [6, 9, 12, 13, 17], [4, 9, 10, 17], [2, 5, 11, 13, 18, 19],\n    [8, 11, 15, 19], [8, 9, 12, 15, 17, 20], [2, 9, 11, 17, 19], [1, 4, 14, 16], [2, 5, 9, 16, 18, 19], [2, 8, 11, 12],\n    [1, 10, 11, 13, 17], [3, 6, 9, 10], [1, 2, 12, 14, 16], [2, 6, 7, 9, 13, 20], [4, 7, 10, 15, 16, 17], [3, 4, 9, 15, 17],\n    [3, 13, 14, 17], [2, 3, 4, 8, 12, 14, 15, 18], [2, 7, 8, 18, 19, 20], [1, 4, 11, 12, 14, 16, 19, 20], [4, 6, 10, 11, 15, 18, 19, 20],\n    [1, 4, 5, 12, 15, 17], [2, 7, 8, 13, 14, 16, 17, 20], [4, 5, 10, 16, 19]\n]\n\n\nmodel = Model()\n\n\nx = boolvar(shape=num_equipment_types)\n\n\nfor requirement in range(1, num_requirements + 1):\n\n    fulfilling_equipment = [j for j in range(num_equipment_types) if requirement in equipment_capabilities[j]]\n    model += sum(x[j] for j in fulfilling_equipment) >= 1\n\n\nmodel.minimize(sum(equipment_costs[j] * x[j] for j in range(num_equipment_types)))\n\n\nif model.solve():\n    selected_equipment = [j+1 for j in range(num_equipment_types) if x[j].value()]\n    total_equipment_cost = sum(equipment_costs[j] for j in range(num_equipment_types) if x[j].value())\n    \n    result = {\n        \"selected_equipment\": selected_equipment,\n        \"total_equipment_cost\": total_equipment_cost\n    }\n    print(json.dumps(result))\nelse:\n    print(\"No solution found\")",
  "evaluation_function": "def evaluate(candidate_solution, structured_data, reference_solution):\n    import json\n    \n    try:\n        solution = json.loads(candidate_solution) if isinstance(candidate_solution, str) else candidate_solution\n    except:\n        return {\"is_valid\": False, \"validation_errors\": [\"Invalid JSON format\"], \"optimality_score\": 0.0}\n    \n    required_fields = [\"selected_equipment\", \"total_equipment_cost\"]\n    missing = [f for f in required_fields if solution is None or f not in solution]\n    if missing:\n        return {\"is_valid\": False, \"validation_errors\": [f\"Missing fields: {missing}\"], \"optimality_score\": 0.0}\n    \n    try:\n        selected_equipment = solution[\"selected_equipment\"]\n        total_equipment_cost = solution[\"total_equipment_cost\"]\n        \n        num_requirements = structured_data[\"num_requirements\"]\n        num_equipment_types = structured_data[\"num_equipment_types\"]\n        equipment_costs = structured_data[\"equipment_costs\"]\n        equipment_capabilities = structured_data[\"equipment_capabilities\"]\n        \n        errors = []\n        \n        if not isinstance(selected_equipment, list):\n            errors.append(\"selected_equipment must be a list\")\n        else:\n            for eq in selected_equipment:\n                if not isinstance(eq, int) or eq < 1 or eq > num_equipment_types:\n                    errors.append(f\"Equipment {eq} is out of bounds (should be between 1 and {num_equipment_types})\")\n        \n        if isinstance(selected_equipment, list) and len(selected_equipment) != len(set(selected_equipment)):\n            errors.append(\"Duplicate equipment in selected_equipment\")\n        \n        if not isinstance(total_equipment_cost, (int, float)) or total_equipment_cost < 0:\n            errors.append(\"total_equipment_cost must be a non-negative number\")\n        \n        if isinstance(selected_equipment, list):\n            try:\n                valid_equipment = [eq for eq in selected_equipment if isinstance(eq, int) and 1 <= eq <= num_equipment_types]\n                calc_cost = sum(equipment_costs[eq - 1] for eq in valid_equipment)\n                if abs(calc_cost - total_equipment_cost) > 1e-6:\n                    errors.append(f\"Cost inconsistency: calculated {calc_cost}, declared {total_equipment_cost}\")\n            except (IndexError, TypeError):\n                errors.append(\"Error calculating equipment cost\")\n        \n        if isinstance(selected_equipment, list):\n            try:\n                unfulfilled_requirements = []\n                for requirement in range(1, num_requirements + 1):\n                    fulfilling_equipment = [j+1 for j in range(num_equipment_types) if requirement in equipment_capabilities[j]]\n                    if not set(fulfilling_equipment).intersection(set(selected_equipment)):\n                        unfulfilled_requirements.append(requirement)\n                \n                if unfulfilled_requirements:\n                    errors.append(f\"Coverage constraint violated: requirements {unfulfilled_requirements[:10]} are not fulfilled\")\n            except (IndexError, TypeError):\n                errors.append(\"Error verifying coverage constraint\")\n        \n        if len(errors) == 0:\n            optimal_cost = reference_solution[\"total_equipment_cost\"]\n            if optimal_cost == 0:\n                optimality_score = 1.0 if total_equipment_cost == 0 else 0.0\n            else:\n                gap = abs(optimal_cost - total_equipment_cost) / abs(optimal_cost)\n                optimality_score = max(0, 1 - gap)\n        else:\n            optimality_score = 0.0\n        \n        return {\n            \"is_valid\": len(errors) == 0,\n            \"validation_errors\": errors,\n            \"optimality_score\": optimality_score\n        }\n        \n    except Exception as e:\n        return {\"is_valid\": False, \"validation_errors\": [\"Format error in solution data\"], \"optimality_score\": 0.0}"
}
{
  "problem_id": "resource_constrained_shortest_path_003",
  "metadata": {
    "problem_type": "Resource Constrained Shortest Path Problem",
    "difficulty": "hard"
  },
  "problem_description": "An advanced sustainable tourism logistics framework requires optimizing autonomous electric shuttle deployment patterns across a comprehensive cultural heritage corridor to establish optimal visitor experience trajectories that minimize comprehensive operational expenditure while conforming to stringent energy utilization parameters and temporal service constraints. The system must select a route containing exactly four locations including the starting point and destination. Sophisticated resource management protocols govern power consumption capped at fifty kilowatt-hours and operational duration limited to forty hours through strategic trajectory planning that balances visitor engagement efficacy against sustainable resource utilization patterns. Location-specific resource utilization profiles include: central hub 0 kilowatt-hours 0 hours, cultural exhibition complex 3 kilowatt-hours 2 hours, heritage preservation site 2 kilowatt-hours 3 hours, botanical research facility 4 kilowatt-hours 2 hours, interactive science center 2 kilowatt-hours 4 hours, wildlife conservation area 3 kilowatt-hours 3 hours, marine life exhibition 4 kilowatt-hours 2 hours, recreational entertainment complex 2 kilowatt-hours 4 hours, coastal scenic area 3 kilowatt-hours 3 hours, elevated observation platform 4 kilowatt-hours 2 hours, natural cascade formation 2 kilowatt-hours 3 hours, subterranean geological formation 4 kilowatt-hours 2 hours, protected ecosystem reserve 2 kilowatt-hours 4 hours, historical fortification structure 4 kilowatt-hours 2 hours, astronomical observation facility 3 kilowatt-hours 3 hours, geothermal therapeutic facility 2 kilowatt-hours 4 hours, ancient spiritual sanctuary 3 kilowatt-hours 2 hours, woodland recreational pathway 4 kilowatt-hours 3 hours, freshwater aquatic body 2 kilowatt-hours 4 hours, civil engineering structure 3 kilowatt-hours 3 hours, renewable energy generation facility 2 kilowatt-hours 4 hours, maritime navigation aid 4 kilowatt-hours 2 hours, coastal maritime community 3 kilowatt-hours 3 hours, artisanal craft production center 2 kilowatt-hours 4 hours, culinary gastronomy establishment 3 kilowatt-hours 3 hours, musical performance venue 2 kilowatt-hours 4 hours, contemporary art installation 4 kilowatt-hours 2 hours, sports training facility 3 kilowatt-hours 3 hours, digital technology hub 2 kilowatt-hours4 hours, and final destination terminal zero kilowatt-hours zero hours. Available transit corridors include: from central hub to interactive science center cost 10 dollars 3 kilowatt-hours 3 hours, to elevated observation platform cost 12 dollars 4 kilowatt-hours 4 hours, to astronomical observation facility cost 15 dollars 5 kilowatt-hours 5 hours, to final destination terminal cost 25 dollars 6 kilowatt-hours 6 hours, from cultural exhibition complex to heritage preservation site cost 8 dollars 2 kilowatt-hours 2 hours, to botanical research facility cost 10 dollars 3 kilowatt-hours 3 hours, to interactive science center cost 12 dollars 4 kilowatt-hours 4 hours, to civil engineering structure cost 15 dollars 5 kilowatt-hours 5 hours, from heritage preservation site to botanical research facility cost 7 dollars 2 kilowatt-hours 2 hours, to wildlife conservation area cost 9 dollars 3 kilowatt-hours 3 hours, to culinary gastronomy establishment cost 18 dollars 4 kilowatt-hours 4 hours,from botanical research facility to interactive science center cost 11 dollars 3 kilowatt-hours 3 hours, to marine life exhibition cost 16 dollars 4 kilowatt-hours 4 hours, to final destination terminal cost 28 dollars 5 kilowatt-hours 5 hours, from interactive science center to astronomical observation facility cost 18 dollars 5 kilowatt-hours 5 hours, to civil engineering structure cost 20 dollars 4 kilowatt-hours 4 hours, to culinary gastronomy establishment cost 22 dollars 3 kilowatt-hours 3 hours, from wildlife conservation area to recreational entertainment complex cost 13 dollars 4 kilowatt-hours 4 hours, to elevated observation platform cost 17 dollars 5 kilowatt-hours 5 hours, from marine life exhibition to coastal scenic area cost 14 dollars 3 kilowatt-hours 3 hours, to natural cascade formation cost 19 dollars 4 kilowatt-hours 4 hours, to astronomical observation facility cost 23 dollars 5 kilowatt-hours 5 hours, from recreational entertainment complex to elevated observation platform cost 12 dollars 4 kilowatt-hours 4 hours, to freshwater aquatic body cost fifteen dollars three kilowatt-hours three hours, to civil engineering structure cost nineteen dollars four kilowatt-hours two hours, from coastal scenic area to natural cascade formation cost 13 dollars 3 kilowatt-hours 3 hours, to protected ecosystem reserve cost 18 dollars 4 kilowatt-hours 4 hours, to culinary gastronomy establishment cost 27 dollars 5 kilowatt-hours 5 hours, from elevated observation platform to civil engineering structure cost 16 dollars 4 kilowatt-hours 4 hours, to final destination terminal cost 14 dollars 3 kilowatt-hours 3 hours, from natural cascade formation to subterranean geological formation cost 15 dollars 4 kilowatt-hours 4 hours, to historical fortification structure cost 20 dollars 5 kilowatt-hours 5 hours, from subterranean geological formation to protected ecosystem reserve cost 11 dollars 3 kilowatt-hours 3 hours, to astronomical observation facility cost 17 dollars 4 kilowatt-hours 4 hours, to final destination terminal cost 29 dollars 5 kilowatt-hours 5 hours, from protected ecosystem reserve to historical fortification structure cost 12 dollars 4 kilowatt-hours 4 hours, to geothermal therapeutic facility cost 18 dollars 5 kilowatt-hours 5 hours, to culinary gastronomy establishment cost 22 dollars 3 kilowatt-hours 3 hours, from historical fortification structure to astronomical observation facility cost 13 dollars 3 kilowatt-hours 3 hours, to ancient spiritual sanctuary cost 19 dollars 4 kilowatt-hours 4 hours, from astronomical observation facility to culinary gastronomy establishment cost 20 dollars 4 kilowatt-hours 4 hours, from geothermal therapeutic facility to ancient spiritual sanctuary cost 14 dollars 4 kilowatt-hours 4 hours, to woodland recreational pathway cost 20 dollars 5 kilowatt-hours 5 hours, to final destination terminal cost 24 dollars 6 kilowatt-hours 6 hours, from ancient spiritual sanctuary to woodland recreational pathway cost 12 dollars 3 kilowatt-hours 3 hours, to freshwater aquatic body cost 17 dollars 4 kilowatt-hours 4 hours, from woodland recreational pathway to freshwater aquatic body cost 13 dollars 4 kilowatt-hours 4 hours, to civil engineering structure cost 18 dollars 5 kilowatt-hours 5 hours, from freshwater aquatic body to civil engineering structure cost 11 dollars 3 kilowatt-hours 3 hours, to renewable energy generation facility cost 16 dollars 4 kilowatt-hours 4 hours, to culinary gastronomy establishment 21 dollars 5 kilowatt-hours 5 hours, from civil engineering structure to final destination terminal cost 14 dollars 3 kilowatt-hours 3 hours, from renewable energy generation facility to maritime navigation aid cost 15 dollars 4 kilowatt-hours 4 hours, to coastal maritime community cost 20 dollars 5 kilowatt-hours 5 hours, to final destination terminal aid cost 25 dollars 6 kilowatt-hours 6 hours, from maritime navigation aid to coastal maritime community cost 12 dollars 3 kilowatt-hours 3 hours, to artisanal craft production center cost 18 dollars 4 kilowatt-hours 4 hours, to culinary gastronomy establishment cost 22 dollars 5 kilowatt-hours 5 hours, from coastal maritime community to artisanal craft production center cost 13 dollars 4 kilowatt-hours 4 hours, to culinary gastronomy establishment cost 19 dollars 5 kilowatt-hours 5 hours, from artisanal craft production center to culinary gastronomy establishment cost 11 dollars 3 kilowatt-hours 3 hours, to musical performance venue cost 16 dollars 4 kilowatt-hours 4 hours, to final destination terminal cost 20 dollars 5 kilowatt-hours 5 hours, from culinary gastronomy establishment to sports training facility cost 10 dollars 3 kilowatt-hours 3 hours, to final destination terminal cost 12 dollars 4 kilowatt-hours 4 hours, from musical performance venue to contemporary art installation cost 14 dollars 4 kilowatt-hours 4 hours, to sports training facility cost 20 dollars 5 kilowatt-hours 5 hours, from contemporary art installation to sports training facility cost 12 dollars 3 kilowatt-hours 3 hours, to digital technology hub cost 17 dollars 4 kilowatt-hours 4 hours, from sports training facility to digital technology hub cost 13 dollars 4 kilowatt-hours 4 hours, to final destination terminal cost 18 dollars 5 kilowatt-hours 5 hours, and from digital technology hub to final destination terminal cost 11 dollars 3 kilowatt-hours 3 hours.",  
  "solution_format_description": "Print the following fields: - visitor_trajectory: sequence of locations visited from start to end. - total_expenditure: total transportation cost. - energy_consumption: total energy used. - temporal_allocation: total time used.",    
  "structured_data": {
    "operational_limits": [50, 40],
    "location_resource_profiles": [
      [0, 0], [3, 2], [2, 3], [4, 2], [2, 4],
      [3, 3], [4, 2], [2, 4], [3, 3], [4, 2],
      [2, 3], [4, 2], [2, 4], [3, 3], [4, 2],
      [2, 3], [3, 3], [2, 4], [4, 2], [3, 3],
      [2, 4], [3, 2], [4, 3], [2, 4], [3, 3],
      [2, 4], [4, 2], [3, 3], [2, 4], [0, 0]
    ],
    "shuttle_transit_corridors": [
      [0, 4, 10, 3, 3], [0, 9, 12, 4, 4], [0, 14, 15, 5, 5], [0, 29, 25, 6, 6],
      [1, 2, 8, 2, 2], [1, 3, 10, 3, 3], [1, 4, 12, 4, 4], [1, 19, 15, 5, 5],
      [2, 3, 7, 2, 2], [2, 5, 9, 3, 3], [2, 24, 18, 4, 4],
      [3, 4, 11, 3, 3], [3, 6, 16, 4, 4], [3, 29, 28, 5, 5],
      [4, 14, 18, 5, 5], [4, 19, 20, 4, 4], [4, 24, 22, 3, 3],
      [5, 7, 13, 4, 4], [5, 9, 17, 5, 5],
      [6, 8, 14, 3, 3], [6, 10, 19, 4, 4], [6, 14, 23, 5, 5],
      [7, 9, 12, 4, 4], [7, 11, 16, 5, 5], [7, 12, 12, 2, 4], [7, 19, 24, 6, 6],
      [8, 10, 13, 3, 3], [8, 12, 18, 4, 4], [8, 24, 27, 5, 5],
      [9, 19, 16, 4, 4], [9, 29, 14, 3, 3],
      [10, 11, 15, 4, 4], [10, 13, 20, 5, 5],
      [11, 12, 11, 3, 3], [11, 14, 17, 4, 4], [11, 29, 29, 5, 5],
      [12, 13, 12, 4, 4], [12, 15, 18, 5, 5], [12, 24, 22, 3, 3],
      [13, 14, 13, 3, 3], [13, 16, 19, 4, 4],
      [14, 24, 20, 4, 4],
      [15, 16, 14, 4, 4], [15, 17, 20, 5, 5], [15, 29, 24, 6, 6],
      [16, 17, 12, 3, 3], [16, 18, 17, 4, 4],
      [17, 18, 13, 4, 4], [17, 19, 18, 5, 5],
      [18, 19, 11, 3, 3], [18, 20, 16, 4, 4], [18, 24, 21, 5, 5],
      [19, 29, 14, 3, 3],
      [20, 21, 15, 4, 4], [20, 22, 20, 5, 5], [20, 29, 25, 6, 6],
      [21, 22, 12, 3, 3], [21, 23, 18, 4, 4], [21, 24, 22, 5, 5],
      [22, 23, 13, 4, 4], [22, 24, 19, 5, 5],
      [23, 24, 11, 3, 3], [23, 25, 16, 4, 4], [23, 29, 20, 5, 5],
      [24, 27, 10, 3, 3], [24, 29, 12, 4, 4],
      [25, 26, 14, 4, 4], [25, 27, 20, 5, 5],
      [26, 27, 12, 3, 3], [26, 28, 17, 4, 4],
      [27, 28, 13, 4, 4], [27, 29, 18, 5, 5],
      [28, 29, 11, 3, 3]
    ]
  },
  "reference_solution": {
    "visitor_trajectory": [0, 9, 19, 29],
    "total_expenditure": 42,
    "energy_consumption": 18,
    "temporal_allocation": 16
  },
  "solver_code": "from cpmpy import *\nimport json\n\noperational_limits = [50, 40]\nlocation_resource_profiles = [\n    [0, 0], [3, 2], [2, 3], [4, 2], [2, 4],\n    [3, 3], [4, 2], [2, 4], [3, 3], [4, 2],\n    [2, 3], [4, 2], [2, 4], [3, 3], [4, 2],\n    [2, 3], [3, 3], [2, 4], [4, 2], [3, 3],\n    [2, 4], [3, 2], [4, 3], [2, 4], [3, 3],\n    [2, 4], [4, 2], [3, 3], [2, 4], [0, 0]\n]\nshuttle_transit_corridors = [\n    [0, 4, 10, 3, 3], [0, 9, 12, 4, 4], [0, 14, 15, 5, 5], [0, 29, 25, 6, 6],\n    [1, 2, 8, 2, 2], [1, 3, 10, 3, 3], [1, 4, 12, 4, 4], [1, 19, 15, 5, 5],\n    [2, 3, 7, 2, 2], [2, 5, 9, 3, 3], [2, 24, 18, 4, 4],\n    [3, 4, 11, 3, 3], [3, 6, 16, 4, 4], [3, 29, 28, 5, 5],\n    [4, 14, 18, 5, 5], [4, 19, 20, 4, 4], [4, 24, 22, 3, 3],\n    [5, 7, 13, 4, 4], [5, 9, 17, 5, 5],\n    [6, 8, 14, 3, 3], [6, 10, 19, 4, 4], [6, 14, 23, 5, 5],\n    [7, 9, 12, 4, 4], [7, 11, 16, 5, 5], [7, 12, 12, 2, 4], [7, 19, 24, 6, 6],\n    [8, 10, 13, 3, 3], [8, 12, 18, 4, 4], [8, 24, 27, 5, 5],\n    [9, 19, 16, 4, 4], [9, 29, 14, 3, 3],\n    [10, 11, 15, 4, 4], [10, 13, 20, 5, 5],\n    [11, 12, 11, 3, 3], [11, 14, 17, 4, 4], [11, 29, 29, 5, 5],\n    [12, 13, 12, 4, 4], [12, 15, 18, 5, 5], [12, 24, 22, 3, 3],\n    [13, 14, 13, 3, 3], [13, 16, 19, 4, 4],\n    [14, 24, 20, 4, 4],\n    [15, 16, 14, 4, 4], [15, 17, 20, 5, 5], [15, 29, 24, 6, 6],\n    [16, 17, 12, 3, 3], [16, 18, 17, 4, 4],\n    [17, 18, 13, 4, 4], [17, 19, 18, 5, 5],\n    [18, 19, 11, 3, 3], [18, 20, 16, 4, 4], [18, 24, 21, 5, 5],\n    [19, 29, 14, 3, 3],\n    [20, 21, 15, 4, 4], [20, 22, 20, 5, 5], [20, 29, 25, 6, 6],\n    [21, 22, 12, 3, 3], [21, 23, 18, 4, 4], [21, 24, 22, 5, 5],\n    [22, 23, 13, 4, 4], [22, 24, 19, 5, 5],\n    [23, 24, 11, 3, 3], [23, 25, 16, 4, 4], [23, 29, 20, 5, 5],\n    [24, 27, 10, 3, 3], [24, 29, 12, 4, 4],\n    [25, 26, 14, 4, 4], [25, 27, 20, 5, 5],\n    [26, 27, 12, 3, 3], [26, 28, 17, 4, 4],\n    [27, 28, 13, 4, 4], [27, 29, 18, 5, 5],\n    [28, 29, 11, 3, 3]\n]\n\nmodel = Model()\n\npath_length = 4\npath = intvar(0, 29, shape=path_length)\n\nmodel += path[0] == 0\nmodel += path[path_length-1] == 29\n\nfor i in range(path_length-1):\n    valid_edges = []\n    for corridor in shuttle_transit_corridors:\n        start, dest, cost, energy, temporal = corridor\n        valid_edges.append((path[i] == start) & (path[i+1] == dest))\n    model += any(valid_edges)\n\ntotal_energy = intvar(0, operational_limits[0])\ntotal_temporal = intvar(0, operational_limits[1])\n\nenergy_expr = 0\ntemporal_expr = 0\n\nfor i in range(path_length):\n    for loc in range(30):\n        energy_expr += (path[i] == loc) * location_resource_profiles[loc][0]\n        temporal_expr += (path[i] == loc) * location_resource_profiles[loc][1]\n\nfor i in range(path_length-1):\n    for corridor in shuttle_transit_corridors:\n        start, dest, cost, energy, temporal = corridor\n        energy_expr += ((path[i] == start) & (path[i+1] == dest)) * energy\n        temporal_expr += ((path[i] == start) & (path[i+1] == dest)) * temporal\n\nmodel += total_energy == energy_expr\nmodel += total_temporal == temporal_expr\n\nmodel += total_energy <= operational_limits[0]\nmodel += total_temporal <= operational_limits[1]\n\ntotal_cost = 0\nfor i in range(path_length-1):\n    for corridor in shuttle_transit_corridors:\n        start, dest, cost, energy, temporal = corridor\n        total_cost += ((path[i] == start) & (path[i+1] == dest)) * cost\n\nmodel.minimize(total_cost)\n\nif model.solve():\n    trajectory = [path[i].value() for i in range(path_length)]\n    \n    result = {\n        \"visitor_trajectory\": trajectory,\n        \"total_expenditure\": total_cost.value(),\n        \"energy_consumption\": total_energy.value(),\n        \"temporal_allocation\": total_temporal.value()\n    }\n    \n    print(json.dumps(result))\nelse:\n    print(json.dumps({\"visitor_trajectory\": [], \"total_expenditure\": -1, \"energy_consumption\": 0, \"temporal_allocation\": 0}))",
  "evaluation_function": "def evaluate(candidate_solution, structured_data, reference_solution):\n    import json\n    \n    try:\n        solution = json.loads(candidate_solution) if isinstance(candidate_solution, str) else candidate_solution\n    except:\n        return {\"is_valid\": False, \"validation_errors\": [\"Invalid JSON format\"], \"optimality_score\": 0.0}\n    \n    required_fields = [\"visitor_trajectory\", \"total_expenditure\", \"energy_consumption\", \"temporal_allocation\"]\n    missing = [f for f in required_fields if solution is None or f not in solution]\n    if missing:\n        return {\"is_valid\": False, \"validation_errors\": [f\"Missing fields: {missing}\"], \"optimality_score\": 0.0}\n    \n    try:\n        trajectory = solution[\"visitor_trajectory\"]\n        total_cost = solution[\"total_expenditure\"]\n        energy_consumption = solution[\"energy_consumption\"]\n        temporal_allocation = solution[\"temporal_allocation\"]\n        \n        operational_limits = structured_data[\"operational_limits\"]\n        location_resource_profiles = structured_data[\"location_resource_profiles\"]\n        shuttle_transit_corridors = structured_data[\"shuttle_transit_corridors\"]\n        \n        errors = []\n        \n        if len(trajectory) != 4:\n            errors.append(f\"Trajectory must have exactly 4 locations, got {len(trajectory)}\")\n        \n        if trajectory[0] != 0:\n            errors.append(\"Trajectory must start at location 0 (central hub)\")\n        \n        if trajectory[-1] != 29:\n            errors.append(\"Trajectory must end at location 29 (final destination terminal)\")\n        \n        num_locations = len(location_resource_profiles)\n        for location in trajectory:\n            if location < 0 or location >= num_locations:\n                errors.append(f\"Invalid location {location} in trajectory\")\n        \n        for i in range(len(trajectory) - 1):\n            current = trajectory[i]\n            next_location = trajectory[i + 1]\n            \n            valid_transition = False\n            for corridor in shuttle_transit_corridors:\n                start, dest, cost, energy, temporal = corridor\n                if start == current and dest == next_location:\n                    valid_transition = True\n                    break\n            \n            if not valid_transition:\n                errors.append(f\"No valid corridor from location {current} to location {next_location}\")\n        \n        calculated_energy = 0\n        calculated_temporal = 0\n        \n        for location in trajectory:\n            calculated_energy += location_resource_profiles[location][0]\n            calculated_temporal += location_resource_profiles[location][1]\n        \n        for i in range(len(trajectory) - 1):\n            current = trajectory[i]\n            next_location = trajectory[i + 1]\n            \n            for corridor in shuttle_transit_corridors:\n                start, dest, cost, energy, temporal = corridor\n                if start == current and dest == next_location:\n                    calculated_energy += energy\n                    calculated_temporal += temporal\n                    break\n        \n        max_energy, max_temporal = operational_limits\n        \n        if calculated_energy > max_energy:\n            errors.append(f\"Energy consumption {calculated_energy} exceeds maximum {max_energy}\")\n        \n        if calculated_temporal > max_temporal:\n            errors.append(f\"Temporal allocation {calculated_temporal} exceeds maximum {max_temporal}\")\n        \n        if abs(calculated_energy - energy_consumption) > 1e-6:\n            errors.append(f\"Energy inconsistency: calculated {calculated_energy}, declared {energy_consumption}\")\n        \n        if abs(calculated_temporal - temporal_allocation) > 1e-6:\n            errors.append(f\"Temporal inconsistency: calculated {calculated_temporal}, declared {temporal_allocation}\")\n        \n        if len(errors) > 0:\n            return {\n                \"is_valid\": False,\n                \"validation_errors\": errors,\n                \"optimality_score\": 0.0\n            }\n        \n        optimal_cost = reference_solution[\"total_expenditure\"]\n        if optimal_cost == 0:\n            optimality_score = 1.0 if total_cost == 0 else 0.0\n        else:\n            gap = abs(optimal_cost - total_cost) / abs(optimal_cost)\n            optimality_score = max(0, 1 - gap)\n            \n        return {\n            \"is_valid\": True,\n            \"validation_errors\": [],\n            \"optimality_score\": optimality_score\n        }\n        \n    except Exception as e:\n        return {\"is_valid\": False, \"validation_errors\": [\"Format error in solution data\"], \"optimality_score\": 0.0}"
}
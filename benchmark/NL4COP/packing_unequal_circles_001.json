{
  "problem_id": "packing_unequal_circles_001",
  "metadata": {
    "problem_type": "Packing Unequal Circles",
    "difficulty": "simple"
  },
  "problem_description": "In a state-of-the-art quantum computing research facility, a team of quantum engineers faces the complex challenge of spatially configuring seven heterogeneous quantum processing units on a semiconductor wafer substrate with a precisely defined 25-micrometer effective operational radius, situated at coordinates (25, 25) within an ultra-low temperature cryogenic chamber operating near absolute zero. Each quantum processing unit possesses unique quantum coherence preservation characteristics and requires specific spatial isolation parameters: unit 1 maintains an 8-micrometer coherence field for spin-orbit coupling optimization; unit 2 requires a 12-micrometer electromagnetic isolation zone for photon emission modulation; unit 3 implements a 5-micrometer quantum tunneling barrier containment field; unit 4 establishes a 15-micrometer many-body entanglement facilitation region; unit 5 provides a 6-micrometer environmental decoherence mitigation perimeter; unit 6 utilizes a 10-micrometer quantum state vector initialization zone; and unit 7 operates with a 9-micrometer temporal coherence extension field. Every activated quantum processing unit must fit completely within the wafer boundaries and keep enough distance from others to avoid quantum interference and maintain stable quantum mechanical behavior. The engineers need to find the best arrangement and placement strategy to get the most units working at the same time while keeping the entire quantum system coherent and compatible.",
  "solution_format_description": "Print the following fields: - activated: activation status for each quantum unit. - positions: for each unit, list coordinates with x, y. - num_active_units: total number of active units.",  
  "structured_data": {
    "wafer": [25, 25, 25],
    "quantum_unit_radii": [8, 12, 5, 15, 6, 10, 9]
  },
  "reference_solution": {
    "activated": [1, 1, 1, 0, 1, 1, 1],
    "positions": [[41, 20], [13, 26], [13, 9], [-1, -1], [19, 43], [34, 37], [27, 10]],
    "num_active_units": 6
  },
  "solver_code": "from cpmpy import *\nimport json\n\ncx = 25\ncy = 25\nR = 25\nradii = [8, 12, 5, 15, 6, 10, 9]\nn = len(radii)\n\nalpha = boolvar(shape=n)\nx = intvar(-R, 2 * R, shape=n)\ny = intvar(-R, 2 * R, shape=n)\n\nmodel = Model()\n\nfor i in range(n):\n    model += (alpha[i] == 0).implies(x[i] == -R)\n    model += (alpha[i] == 0).implies(y[i] == -R)\n\nfor i in range(n):\n    r = radii[i]\n    if (R - r) < 0:\n        model += alpha[i] == 0\n    else:\n        rhs_sq = (R - r) ** 2\n        dist_sq = (x[i] - cx)**2 + (y[i] - cy)**2\n        model += alpha[i].implies(dist_sq <= rhs_sq)\n\nM = 4 * R * R\nfor i in range(n):\n    for j in range(i + 1, n):\n        r_i, r_j = radii[i], radii[j]\n        rhs_sq = (r_i + r_j) ** 2\n        dist_sq = (x[i] - x[j])**2 + (y[i] - y[j])**2\n        model += dist_sq >= rhs_sq - M * (2 - alpha[i] - alpha[j])\n\nmodel.maximize(sum(alpha))\n\nif model.solve():\n    activated = [int(alpha[i].value()) for i in range(n)]\n    positions = [(int(x[i].value()), int(y[i].value())) if activated[i] else (-1, -1) for i in range(n)]\n    num_active_units = sum(activated)\n    \n    result = {\n        \"activated\": activated,\n        \"positions\": positions,\n        \"num_active_units\": num_active_units\n    }\n    print(json.dumps(result))\nelse:\n    print(\"No solution found.\")",
  "evaluation_function": "def evaluate(candidate_solution, structured_data, reference_solution):\n    import json\n    import math\n    \n    try:\n        solution = json.loads(candidate_solution) if isinstance(candidate_solution, str) else candidate_solution\n    except:\n        return {\"is_valid\": False, \"validation_errors\": [\"Invalid JSON format\"], \"optimality_score\": 0.0}\n    \n    required_fields = [\"activated\", \"positions\", \"num_active_units\"]\n    missing = [f for f in required_fields if solution is None or f not in solution]\n    if missing:\n        return {\"is_valid\": False, \"validation_errors\": [f\"Missing fields: {missing}\"], \"optimality_score\": 0.0}\n    \n    try:\n        activated = solution[\"activated\"]\n        positions = solution[\"positions\"]\n        num_active_units = solution[\"num_active_units\"]\n        errors = []\n        \n        cx, cy, container_R = structured_data[\"wafer\"]\n        radii = structured_data[\"quantum_unit_radii\"]\n        n = len(radii)\n        \n        for i in range(n):\n            if activated[i] == 1:\n                x, y = positions[i]\n                r = radii[i]\n                dist = math.sqrt((x - cx)**2 + (y - cy)**2)\n                if dist > container_R - r:\n                    errors.append(f\"Quantum unit {i+1} exceeds wafer boundary\")\n        \n        for i in range(n):\n            if activated[i] == 1:\n                for j in range(i + 1, n):\n                    if activated[j] == 1:\n                        x1, y1 = positions[i]\n                        x2, y2 = positions[j]\n                        r1, r2 = radii[i], radii[j]\n                        dist = math.sqrt((x1 - x2)**2 + (y1 - y2)**2)\n                        if dist < r1 + r2:\n                            errors.append(f\"Quantum units {i+1} and {j+1} overlap\")\n        \n        if len(errors) > 0:\n            optimality_score = 0.0\n        else:\n            optimal_value = reference_solution[\"num_active_units\"]\n            if optimal_value == 0:\n                optimality_score = 1.0 if num_active_units == 0 else 0.0\n            else:\n                gap = abs(optimal_value - num_active_units) / abs(optimal_value)\n                optimality_score = max(0, 1 - gap)\n        \n        return {\n            \"is_valid\": len(errors) == 0,\n            \"validation_errors\": errors,\n            \"optimality_score\": optimality_score\n        }\n        \n    except Exception:\n        return {\"is_valid\": False, \"validation_errors\": [\"Format error in solution data\"], \"optimality_score\": 0.0}"
}
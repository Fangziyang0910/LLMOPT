{
  "problem_id": "equitable_partitioning_001",
  "metadata": {
    "problem_type": "Equitable Partitioning Problem",
    "difficulty": "simple"
  },
  "problem_description": "Within the advanced strategic operational framework of an interdisciplinary innovation laboratory, a sophisticated human capital optimization paradigm is being deployed requiring the methodical orchestration of exactly 8 specialized research groups from a cohort of 40 students. Each student possesses a unique skill assessment profile characterized by two distinct professional dimensions: advanced computational proficiency and empirical research methodology expertise. The comprehensive skill assessment matrix reveals that for the first skill assessment dimension (computational proficiency), students 1, 4, 6, 9, 11, 14, 16, 17, 23, 25, 26, 29, 31, 33, 36, and 37 demonstrate advanced capabilities. Concurrently, the second skill assessment dimension (research methodology) indicates that students 2, 6, 13, 18, 21, 28, 31, and 38 exhibit sophisticated research skills. To ensure that the comprehensive capabilities of the 8 groups are evenly matched through optimal skill assessment distribution, how should the laboratory orchestrate the strategic grouping of students to minimize total skill imbalance across all assessment dimensions?",
  "solution_format_description": "Print the following fields: - student_group_assignment: group assignment for each student. - total_skill_imbalance: total skill imbalance across all groups.",
  "structured_data": {
    "num_students": 40,
    "num_skills": 2,
    "num_groups": 8,
    "skill_assessments": [
      [1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0],
      [0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0]
    ]
  },
  "reference_solution": {
    "student_group_assignment": [1, 7, 8, 8, 8, 8, 8, 8, 7, 8, 7, 8, 6, 6, 8, 6, 5, 5, 8, 8, 4, 8, 5, 8, 4, 4, 8, 2, 3, 8, 3, 8, 2, 8, 8, 2, 1, 1, 7, 8],
    "total_skill_imbalance": 0.0
  },
  "solver_code": "from cpmpy import *\nimport json\n\nskill_assessments = [\n    [1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0],\n    [0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0]\n]\nnum_students = 40\nnum_groups = 8\n\nmodel = Model()\nstudent_group_assignment = intvar(1, num_groups, shape=num_students)\n\nfor g in range(1, num_groups + 1):\n    model += sum(student_group_assignment == g) >= 1\n\ntotal_skill_imbalance = 0\nfor skill_idx in range(2):\n    group_counts = []\n    for g in range(1, num_groups + 1):\n        group_count = sum(skill_assessments[skill_idx][i] * (student_group_assignment[i] == g) for i in range(num_students))\n        group_counts.append(group_count)\n    \n    mean_count = sum(skill_assessments[skill_idx]) // num_groups\n    for g in range(num_groups):\n        total_skill_imbalance += abs(group_counts[g] - mean_count)\n\nmodel.minimize(total_skill_imbalance)\n\nif model.solve():\n    assignment_solution = [int(student_group_assignment[i].value()) for i in range(num_students)]\n    \n    final_imbalance = 0.0\n    for skill_idx in range(2):\n        group_counts = [0] * num_groups\n        for i in range(num_students):\n            group_id = assignment_solution[i] - 1\n            group_counts[group_id] += skill_assessments[skill_idx][i]\n        mean_count = sum(skill_assessments[skill_idx]) / num_groups\n        final_imbalance += sum(abs(count - mean_count) for count in group_counts)\n    \n    result = {\n        \"student_group_assignment\": assignment_solution,\n        \"total_skill_imbalance\": final_imbalance\n    }\n    \n    print(json.dumps(result))",
  "evaluation_function": "def evaluate(candidate_solution, structured_data, reference_solution):\n    import json\n    \n    try:\n        solution = json.loads(candidate_solution) if isinstance(candidate_solution, str) else candidate_solution\n    except:\n        return {\"is_valid\": False, \"validation_errors\": [\"Invalid JSON format\"], \"optimality_score\": 0.0}\n    \n    required_fields = [\"student_group_assignment\", \"total_skill_imbalance\"]\n    missing = [f for f in required_fields if solution is None or f not in solution]\n    if missing:\n        return {\"is_valid\": False, \"validation_errors\": [f\"Missing fields: {missing}\"], \"optimality_score\": 0.0}\n    \n    try:\n        assignment = solution[\"student_group_assignment\"]\n        total_skill_imbalance = solution[\"total_skill_imbalance\"]\n        skill_assessments = structured_data[\"skill_assessments\"]\n        num_students = structured_data[\"num_students\"]\n        num_groups = structured_data[\"num_groups\"]\n        errors = []\n        \n        if len(assignment) != num_students:\n            errors.append(f\"Assignment length mismatch: expected {num_students}, got {len(assignment)}\")\n        \n        for i, group_id in enumerate(assignment):\n            if not isinstance(group_id, int) or group_id < 1 or group_id > num_groups:\n                errors.append(f\"Invalid group assignment at position {i}: {group_id}, must be 1-{num_groups}\")\n                break\n        \n        used_groups = set(assignment)\n        if len(used_groups) != num_groups:\n            missing_groups = set(range(1, num_groups + 1)) - used_groups\n            errors.append(f\"Not all groups are used, missing groups: {sorted(missing_groups)}\")\n        \n        if errors:\n            return {\"is_valid\": False, \"validation_errors\": errors, \"optimality_score\": 0.0}\n        \n        calculated_imbalance = 0.0\n        for skill_idx in range(len(skill_assessments)):\n            group_counts = [0] * num_groups\n            for i in range(num_students):\n                group_id = assignment[i] - 1\n                group_counts[group_id] += skill_assessments[skill_idx][i]\n            \n            mean_count = sum(skill_assessments[skill_idx]) / num_groups\n            skill_imbalance = sum(abs(count - mean_count) for count in group_counts)\n            calculated_imbalance += skill_imbalance\n        \n        if abs(calculated_imbalance - total_skill_imbalance) > 1e-6:\n            errors.append(f\"Skill imbalance inconsistency: calculated {calculated_imbalance}, declared {total_skill_imbalance}\")\n        \n        if len(errors) == 0:\n            optimal_imbalance = reference_solution[\"total_skill_imbalance\"]\n            if optimal_imbalance == 0:\n                optimality_score = 1.0 if calculated_imbalance == 0 else 0.0\n            else:\n                gap = abs(optimal_imbalance - calculated_imbalance) / abs(optimal_imbalance)\n                optimality_score = max(0, 1 - gap)\n        else:\n            optimality_score = 0.0\n        \n        return {\n            \"is_valid\": len(errors) == 0,\n            \"validation_errors\": errors,\n            \"optimality_score\": optimality_score\n        }\n        \n    except Exception as e:\n        return {\"is_valid\": False, \"validation_errors\": [\"Format error in solution data\"], \"optimality_score\": 0.0}"
}
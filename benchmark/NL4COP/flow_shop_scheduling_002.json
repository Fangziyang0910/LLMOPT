{
  "problem_id": "flow_shop_scheduling_002",
  "metadata": {
    "problem_type": "Flow Shop Scheduling Problem",
    "difficulty": "medium"
  },
  "problem_description": "Within the intricate operational framework of an automotive service conglomerate, fifteen distinct automotive units require systematic processing through a quintet of specialized diagnostic and repair stations operating under rigorous temporal constraints. Each unit must traverse the entire service pipeline in a predetermined technological sequence, where each station possesses exclusive processing capabilities that cannot be simultaneously allocated to multiple units. The service paradigm enforces a strict precedence relationship: units cannot commence processing at subsequent stations until completion at the preceding station, while each station maintains unitary processing capacity at any given temporal interval. The service requirements exhibit significant heterogeneity across both units and stations, creating a complex multidimensional optimization landscape. Unit Alpha-001 requires eighty minutes at the engine diagnostics station, fifty-nine minutes at the transmission service station, fifty-nine minutes at the brake system station, thirty-one minutes at the electrical systems station, and thirty minutes at the final inspection station. Unit Beta-002 demonstrates extended service demands with thirteen minutes at engine diagnostics, eighty-three minutes at transmission service, seventy minutes at brake system, sixty-four minutes at electrical systems, and eighty-eight minutes at final inspection respectively across the sequential stations. Unit Gamma-003 exhibits intermediate processing characteristics with sixty-four minutes at engine diagnostics, eighty-five minutes at transmission service, seventy-six minutes at brake system, eleven minutes at electrical systems, and fourteen minutes at final inspection. Unit Delta-004's service profile encompasses seventy-seven minutes at engine diagnostics, eighty-five minutes at transmission service, ten minutes at brake system, nine minutes at electrical systems, and twenty-two minutes at final inspection, while Unit Epsilon-005 requires seventeen minutes at engine diagnostics, seventy minutes at transmission service, sixty-five minutes at brake system, thirty-two minutes at electrical systems, and ninety-three minutes at final inspection across the service sequence. Unit Zeta-006 demonstrates elevated processing demands with seventy-eight minutes at engine diagnostics, thirty-five minutes at transmission service, nineteen minutes at brake system, fifty-eight minutes at electrical systems, and forty-eight minutes at final inspection. Unit Eta-007's service requirements escalate to eighty-two minutes at engine diagnostics, two minutes at transmission service, seventy-seven minutes at brake system, ninety-eight minutes at electrical systems, and ten minutes at final inspection. Unit Theta-008 exhibits substantial processing intensity with four minutes at engine diagnostics, seventy-six minutes at transmission service, eighty-six minutes at brake system, ninety-five minutes at electrical systems, and seven minutes at final inspection. Unit Iota-009 requires seventy-two minutes at engine diagnostics, forty-six minutes at transmission service, twenty-one minutes at brake system, twenty-five minutes at electrical systems, and fourteen minutes at final inspection. Unit Kappa-010 demonstrates extended processing demands with ninety-three minutes at engine diagnostics, seventy-two minutes at transmission service, seventy-five minutes at brake system, four minutes at electrical systems, and ninety-one minutes at final inspection. Unit Lambda-011 exhibits complex service characteristics with sixty-eight minutes at engine diagnostics, sixty-nine minutes at transmission service, ninety-six minutes at brake system, forty-five minutes at electrical systems, and five minutes at final inspection. Unit Mu-012's service profile encompasses twenty-five minutes at engine diagnostics, forty-six minutes at transmission service, three minutes at brake system, sixty minutes at electrical systems, and forty-three minutes at final inspection. Unit Nu-013 requires sixty-seven minutes at engine diagnostics, three minutes at transmission service, fifty minutes at brake system, eighty-seven minutes at electrical systems, and thirty minutes at final inspection. Unit Xi-014 demonstrates elevated processing demands with eighty minutes at engine diagnostics, fifty-seven minutes at transmission service, fifty-seven minutes at brake system, thirty-one minutes at electrical systems, and seventy-nine minutes at final inspection. Unit Omicron-015's processing requirements encompass forty-three minutes at engine diagnostics, seventy-one minutes at transmission service, sixty-six minutes at brake system, one minute at electrical systems, and thirty-nine minutes at final inspection across the sequential service stations. How should the service management sequence these fifteen automotive units through the diagnostic and repair pipeline to achieve the shortest possible total service time for completing the entire fleet maintenance cycle?",
  "solution_format_description": "Print the following fields: - unit_sequence: service order for automotive units. - total_service_time: total time to complete all services.",
  "structured_data": {
    "automotive_units": 15,
    "service_stations": 5,
    "service_time_matrix": [
      [80, 59, 59, 31, 30],
      [13, 83, 70, 64, 88],
      [64, 85, 76, 11, 14],
      [77, 85, 10, 9, 22],
      [17, 70, 65, 32, 93],
      [78, 35, 19, 58, 48],
      [82, 2, 77, 98, 10],
      [4, 76, 86, 95, 7],
      [72, 46, 21, 25, 14],
      [93, 72, 75, 4, 91],
      [68, 69, 96, 45, 5],
      [25, 46, 3, 60, 43],
      [67, 3, 50, 87, 30],
      [80, 57, 57, 31, 79],
      [43, 71, 66, 1, 39]
    ]
  },
  "reference_solution": {
    "unit_sequence": [8, 13, 5, 2, 7, 14, 3, 12, 15, 6, 10, 11, 1, 4, 9],
    "total_service_time": 982
  },
  "solver_code": "from cpmpy import *\nimport json\n\nautomotive_units = 15\nservice_stations = 5\nservice_time_matrix = [\n    [80, 59, 59, 31, 30],\n    [13, 83, 70, 64, 88],\n    [64, 85, 76, 11, 14],\n    [77, 85, 10, 9, 22],\n    [17, 70, 65, 32, 93],\n    [78, 35, 19, 58, 48],\n    [82, 2, 77, 98, 10],\n    [4, 76, 86, 95, 7],\n    [72, 46, 21, 25, 14],\n    [93, 72, 75, 4, 91],\n    [68, 69, 96, 45, 5],\n    [25, 46, 3, 60, 43],\n    [67, 3, 50, 87, 30],\n    [80, 57, 57, 31, 79],\n    [43, 71, 66, 1, 39]\n]\n\nunit_sequence = intvar(1, automotive_units, shape=automotive_units)\n\nmodel = Model()\n\nmodel += AllDifferent(unit_sequence)\n\ncompletion = [[intvar(0, 10000) for _ in range(service_stations)] for _ in range(automotive_units)]\n\nfor i in range(automotive_units):\n    for j in range(service_stations):\n        unit_idx = unit_sequence[i] - 1\n        proc_time = Element([service_time_matrix[u][j] for u in range(automotive_units)], unit_idx)\n        \n        if i == 0 and j == 0:\n            model += (completion[i][j] == proc_time)\n        elif i == 0:\n            model += (completion[i][j] == completion[i][j-1] + proc_time)\n        elif j == 0:\n            model += (completion[i][j] == completion[i-1][j] + proc_time)\n        else:\n            model += (completion[i][j] == max(completion[i-1][j], completion[i][j-1]) + proc_time)\n\ntotal_service_time = completion[automotive_units-1][service_stations-1]\n\nmodel.minimize(total_service_time)\n\nif model.solve():\n    result = {\n        \"unit_sequence\": [int(unit_sequence[i].value()) for i in range(automotive_units)],\n        \"total_service_time\": int(total_service_time.value())\n    }\n    print(json.dumps(result))\nelse:\n    print(\"No solution found\")",
  "evaluation_function": "def evaluate(candidate_solution, structured_data, reference_solution):\n    import json\n    \n    try:\n        solution = json.loads(candidate_solution) if isinstance(candidate_solution, str) else candidate_solution\n    except:\n        return {\"is_valid\": False, \"validation_errors\": [\"Invalid JSON format\"], \"optimality_score\": 0.0}\n    \n    required_fields = [\"unit_sequence\", \"total_service_time\"]\n    missing = [f for f in required_fields if solution is None or f not in solution]\n    if missing:\n        return {\"is_valid\": False, \"validation_errors\": [f\"Missing fields: {missing}\"], \"optimality_score\": 0.0}\n    \n    try:\n        unit_sequence = solution[\"unit_sequence\"]\n        candidate_total_time = solution[\"total_service_time\"]\n        \n        automotive_units = structured_data[\"automotive_units\"]\n        service_stations = structured_data[\"service_stations\"]\n        service_time_matrix = structured_data[\"service_time_matrix\"]\n        errors = []\n        \n        if len(unit_sequence) != automotive_units:\n            errors.append(f\"unit_sequence length mismatch: expected {automotive_units}, got {len(unit_sequence)}\")\n        \n        expected_set = set(range(1, automotive_units + 1))\n        actual_set = set(unit_sequence)\n        if actual_set != expected_set:\n            missing = expected_set - actual_set\n            extra = actual_set - expected_set\n            if missing:\n                errors.append(f\"Missing unit IDs: {sorted(list(missing))}\")\n            if extra:\n                errors.append(f\"Extra unit IDs: {sorted(list(extra))}\")\n        \n        if len(errors) > 0:\n            return {\"is_valid\": False, \"validation_errors\": errors, \"optimality_score\": 0.0}\n        \n        seq_zero = [unit - 1 for unit in unit_sequence]\n        completion = [[0] * service_stations for _ in range(automotive_units)]\n        \n        for i in range(automotive_units):\n            for j in range(service_stations):\n                proc_time = service_time_matrix[seq_zero[i]][j]\n                if i == 0 and j == 0:\n                    completion[i][j] = proc_time\n                elif i == 0:\n                    completion[i][j] = completion[i][j - 1] + proc_time\n                elif j == 0:\n                    completion[i][j] = completion[i - 1][j] + proc_time\n                else:\n                    completion[i][j] = max(completion[i - 1][j], completion[i][j - 1]) + proc_time\n        \n        calculated_total_time = completion[-1][-1]\n        \n        if abs(calculated_total_time - candidate_total_time) > 1e-6:\n            errors.append(f\"Total service time inconsistency: calculated {calculated_total_time}, declared {candidate_total_time}\")\n        \n        if len(errors) > 0:\n            optimality_score = 0.0\n        else:\n            optimal_value = reference_solution[\"total_service_time\"]\n            if optimal_value == 0:\n                optimality_score = 1.0 if candidate_total_time == 0 else 0.0\n            else:\n                gap = abs(optimal_value - candidate_total_time) / abs(optimal_value)\n                optimality_score = max(0, 1 - gap)\n        \n        return {\n            \"is_valid\": len(errors) == 0,\n            \"validation_errors\": errors,\n            \"optimality_score\": optimality_score\n        }\n        \n    except Exception:\n        return {\"is_valid\": False, \"validation_errors\": [\"Format error in solution data\"], \"optimality_score\": 0.0}"
}
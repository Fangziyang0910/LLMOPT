{
  "problem_id": "equitable_partitioning_002",
  "metadata": {
    "problem_type": "Equitable Partitioning Problem",
    "difficulty": "medium"
  },
  "problem_description": "Within the advanced strategic operational framework of a cutting-edge technology corporation undergoing a comprehensive organizational transformation paradigm, a sophisticated human capital optimization protocol requires the methodical orchestration of 8 cross-functional project teams from a workforce of 40 employees for a critical software engineering endeavor. Each employee possesses a multidimensional competency assessment framework evaluated across four distinct domains: technical proficiency, leadership acumen, analytical reasoning capabilities, and interpersonal communication effectiveness. The comprehensive competency assessment matrix reveals that for the first competency assessment dimension (technical proficiency), employees 3, 6, 7, 12, 18, 19, 20, 21, 23, 25, 29, 31, 33, 35, 36, and 38 demonstrate advanced technical capabilities. The second competency assessment dimension (leadership acumen) indicates that employees 1, 2, 3, 5, 6, 9, 11, 12, 14, 16, 17, 18, 19, 20, 23, 24, 26, 29, 30, 31, 32, 33, 35, 36, 37, and 39 exhibit sophisticated leadership competencies. The third competency assessment dimension (analytical reasoning) shows that employees 2, 3, 5, 8, 10, 11, 12, 16, 21, 23, 27, 28, 30, 32, 37, and 39 possess advanced analytical capabilities. The fourth competency assessment dimension (communication effectiveness) demonstrates that employees 2, 6, 9, 10, 11, 12, 14, 15, 18, 20, 21, 23, 25, 27, 28, 29, 31, 33, 35, 36, and 37 exhibit superior communication proficiencies. How should the corporation orchestrate the strategic distribution of employees to maximize the synergistic effectiveness of the 8 project teams while ensuring that each team's comprehensive competency portfolio achieves optimal equilibrium through minimal total competency imbalance across all assessment dimensions?",
  "solution_format_description": "Print the following fields: - employee_team_assignment: team assignment for each employee. - total_competency_imbalance: total competency imbalance across all teams.",
  "structured_data": {
    "num_employees": 40,
    "num_competencies": 4,
    "num_teams": 8,
    "competency_assessments": [
      [0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0],
      [1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0],
      [0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0],
      [0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0]
    ]
  },
  "reference_solution": {
    "employee_team_assignment": [2, 7, 5, 8, 8, 8, 1, 7, 5, 8, 6, 6, 8, 3, 5, 4, 8, 4, 7, 2, 2, 8, 3, 4, 4, 1, 4, 1, 1, 3, 3, 2, 6, 8, 7, 8, 1, 5, 5, 8],
    "total_competency_imbalance": 6.75
  },
  "solver_code": "from cpmpy import *\nimport json\n\ncompetency_assessments = [\n    [0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0],\n    [1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0],\n    [0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0],\n    [0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0]\n]\nnum_employees = 40\nnum_teams = 8\n\nmodel = Model()\nemployee_team_assignment = intvar(1, num_teams, shape=num_employees)\n\nfor t in range(1, num_teams + 1):\n    model += sum(employee_team_assignment == t) >= 1\n\ntotal_competency_imbalance = 0\nfor comp_idx in range(4):\n    team_counts = []\n    for t in range(1, num_teams + 1):\n        team_count = sum(competency_assessments[comp_idx][i] * (employee_team_assignment[i] == t) for i in range(num_employees))\n        team_counts.append(team_count)\n    \n    total_count = sum(competency_assessments[comp_idx])\n    for t in range(num_teams):\n        diff = abs(8 * team_counts[t] - total_count)\n        total_competency_imbalance += diff\n\nmodel.minimize(total_competency_imbalance)\n\nif model.solve():\n    assignment_solution = [int(employee_team_assignment[i].value()) for i in range(num_employees)]\n    \n    final_imbalance = 0.0\n    for comp_idx in range(4):\n        team_counts = [0] * num_teams\n        for i in range(num_employees):\n            team_id = assignment_solution[i] - 1\n            team_counts[team_id] += competency_assessments[comp_idx][i]\n        mean_count = sum(competency_assessments[comp_idx]) / num_teams\n        final_imbalance += sum(abs(count - mean_count) for count in team_counts)\n    \n    result = {\n        \"employee_team_assignment\": assignment_solution,\n        \"total_competency_imbalance\": final_imbalance\n    }\n    \n    print(json.dumps(result))",
  "evaluation_function": "def evaluate(candidate_solution, structured_data, reference_solution):\n    import json\n    \n    try:\n        solution = json.loads(candidate_solution) if isinstance(candidate_solution, str) else candidate_solution\n    except:\n        return {\"is_valid\": False, \"validation_errors\": [\"Invalid JSON format\"], \"optimality_score\": 0.0}\n    \n    required_fields = [\"employee_team_assignment\", \"total_competency_imbalance\"]\n    missing = [f for f in required_fields if solution is None or f not in solution]\n    if missing:\n        return {\"is_valid\": False, \"validation_errors\": [f\"Missing fields: {missing}\"], \"optimality_score\": 0.0}\n    \n    try:\n        assignment = solution[\"employee_team_assignment\"]\n        total_competency_imbalance = solution[\"total_competency_imbalance\"]\n        competency_assessments = structured_data[\"competency_assessments\"]\n        num_employees = structured_data[\"num_employees\"]\n        num_teams = structured_data[\"num_teams\"]\n        errors = []\n        \n        if len(assignment) != num_employees:\n            errors.append(f\"Assignment length mismatch: expected {num_employees}, got {len(assignment)}\")\n        \n        for i, team_id in enumerate(assignment):\n            if not isinstance(team_id, int) or team_id < 1 or team_id > num_teams:\n                errors.append(f\"Invalid team assignment at position {i}: {team_id}, must be 1-{num_teams}\")\n                break\n        \n        used_teams = set(assignment)\n        if len(used_teams) != num_teams:\n            missing_teams = set(range(1, num_teams + 1)) - used_teams\n            errors.append(f\"Not all teams are used, missing teams: {sorted(missing_teams)}\")\n        \n        if errors:\n            return {\"is_valid\": False, \"validation_errors\": errors, \"optimality_score\": 0.0}\n        \n        calculated_imbalance = 0.0\n        for comp_idx in range(len(competency_assessments)):\n            team_counts = [0] * num_teams\n            for i in range(num_employees):\n                team_id = assignment[i] - 1\n                team_counts[team_id] += competency_assessments[comp_idx][i]\n            \n            mean_count = sum(competency_assessments[comp_idx]) / num_teams\n            comp_imbalance = sum(abs(count - mean_count) for count in team_counts)\n            calculated_imbalance += comp_imbalance\n        \n        if abs(calculated_imbalance - total_competency_imbalance) > 1e-6:\n            errors.append(f\"Competency imbalance inconsistency: calculated {calculated_imbalance}, declared {total_competency_imbalance}\")\n        \n        if len(errors) == 0:\n            optimal_imbalance = reference_solution[\"total_competency_imbalance\"]\n            if optimal_imbalance == 0:\n                optimality_score = 1.0 if calculated_imbalance == 0 else 0.0\n            else:\n                gap = abs(optimal_imbalance - calculated_imbalance) / abs(optimal_imbalance)\n                optimality_score = max(0, 1 - gap)\n        else:\n            optimality_score = 0.0\n        \n        return {\n            \"is_valid\": len(errors) == 0,\n            \"validation_errors\": errors,\n            \"optimality_score\": optimality_score\n        }\n        \n    except Exception as e:\n        return {\"is_valid\": False, \"validation_errors\": [\"Format error in solution data\"], \"optimality_score\": 0.0}"
}
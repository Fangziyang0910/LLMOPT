{
  "problem_id": "graph_coloring_002",
  "metadata": {
    "problem_type": "Graph Coloring Problem",
    "difficulty": "medium"
  },
  "problem_description": "Within the advanced strategic operational framework of the Fifth Generation Network Optimization Initiative, a sophisticated frequency resource allocation paradigm is being deployed for a comprehensive cellular communications infrastructure comprising thirty distinct towers positioned throughout a complex urban geographical topology. The initiative's advanced network management systems have identified intricate conflict relationship patterns that establish mutual exclusivity constraints between geographically proximate tower infrastructure elements. The complex spatial constraint matrix reveals that towers exhibiting mutual conflict relationships must be allocated distinct frequency assignments to preserve signal integrity and maintain optimal network performance characteristics. The comprehensive network topology analysis has systematically determined the following tower pair configurations experience conflict interactions: towers 1 and 2 demonstrate mutual incompatibility, towers 1 and 3 exhibit conflict relationships, towers 1 and 4 share mutual constraints, towers 2 and 3 experience interference patterns, towers 2 and 4 demonstrate conflict interactions, towers 3 and 4 exhibit mutual incompatibility, towers 1 and 5 experience reciprocal conflicts, towers 2 and 6 demonstrate cross-cluster interference, towers 3 and 7 experience conflict relationships, towers 4 and 8 exhibit mutual incompatibility, towers 5 and 6 share mutual constraints, towers 6 and 7 experience interference patterns, towers 5 and 7 demonstrate conflict interactions, towers 6 and 8 exhibit mutual incompatibility, towers 9 and 10 experience reciprocal conflicts, towers 10 and 11 demonstrate cross-cluster interference, towers 11 and 9 experience conflict relationships, towers 9 and 12 exhibit mutual incompatibility, towers 10 and 12 share mutual constraints, towers 11 and 12 experience interference patterns, towers 12 and 13 demonstrate conflict interactions, towers 13 and 14 exhibit mutual incompatibility, towers 12 and 14 share mutual constraints, towers 15 and 9 experience reciprocal conflicts, towers 15 and 14 demonstrate cross-cluster interference, towers 15 and 8 experience conflict relationships, towers 15 and 7 exhibit mutual incompatibility, towers 9 and 14 share mutual constraints, towers 9 and 8 experience interference patterns, towers 9 and 7 demonstrate conflict interactions, towers 14 and 8 exhibit mutual incompatibility, towers 14 and 7 share mutual constraints, towers 8 and 7 experience interference patterns, towers 16 and 17 demonstrate conflict interactions, towers 16 and 18 exhibit mutual incompatibility, towers 17 and 18 share mutual constraints, towers 16 and 19 experience reciprocal conflicts, towers 16 and 20 demonstrate cross-cluster interference, towers 16 and 21 experience conflict relationships, towers 17 and 19 exhibit mutual incompatibility, towers 17 and 20 share mutual constraints, towers 17 and 21 experience interference patterns, towers 18 and 19 demonstrate conflict interactions, towers 18 and 20 exhibit mutual incompatibility, towers 18 and 21 share mutual constraints, towers 19 and 20 experience interference patterns, towers 19 and 21 demonstrate conflict interactions, towers 20 and 21 exhibit mutual incompatibility, towers 22 and 16 share mutual constraints, towers 22 and 21 experience interference patterns, towers 22 and 6 demonstrate conflict interactions, towers 22 and 14 exhibit mutual incompatibility, towers 16 and 21 share mutual constraints, towers 16 and 6 experience interference patterns, towers 16 and 14 demonstrate conflict interactions, towers 21 and 6 exhibit mutual incompatibility, towers 21 and 14 share mutual constraints, towers 6 and 14 experience interference patterns, towers 23 and 24 demonstrate conflict interactions, towers 23 and 25 exhibit mutual incompatibility, towers 23 and 26 share mutual constraints, towers 23 and 27 experience interference patterns, towers 23 and 2 demonstrate conflict interactions, towers 23 and 1 exhibit mutual incompatibility, towers 23 and 3 share mutual constraints, towers 23 and 4 experience interference patterns, towers 23 and 5 demonstrate conflict interactions, towers 24 and 25 exhibit mutual incompatibility, towers 24 and 26 share mutual constraints, towers 24 and 27 experience interference patterns, towers 24 and 28 demonstrate conflict interactions, towers 24 and 29 exhibit mutual incompatibility, towers 24 and 30 share mutual constraints, towers 25 and 26 experience interference patterns, towers 25 and 27 demonstrate conflict interactions, towers 25 and 28 exhibit mutual incompatibility, towers 25 and 29 share mutual constraints, towers 25 and 30 experience interference patterns, towers 26 and 27 demonstrate conflict interactions, towers 26 and 28 exhibit mutual incompatibility, towers 26 and 29 share mutual constraints, towers 26 and 30 experience interference patterns, towers 27 and 28 demonstrate conflict interactions, towers 27 and 29 exhibit mutual incompatibility, towers 27 and 30 share mutual constraints, towers 28 and 29 experience interference patterns, towers 28 and 30 demonstrate conflict interactions, towers 29 and 30 exhibit mutual incompatibility, towers 15 and 23 share mutual constraints, towers 22 and 27 experience interference patterns, towers 24 and 28 demonstrate conflict interactions, towers 25 and 29 exhibit mutual incompatibility, towers 26 and 30 share mutual constraints, towers 1 and 17 experience interference patterns, towers 5 and 9 demonstrate conflict interactions, towers 9 and 13 exhibit mutual incompatibility, towers 13 and 17 share mutual constraints, towers 4 and 19 experience interference patterns, towers 11 and 26 demonstrate conflict interactions, towers 18 and 30 exhibit mutual incompatibility, towers 1 and 6 share mutual constraints, towers 2 and 7 experience interference patterns, towers 3 and 8 demonstrate conflict interactions, towers 5 and 8 exhibit mutual incompatibility, towers 10 and 15 share mutual constraints, towers 12 and 15 experience interference patterns, towers 3 and 12 demonstrate conflict interactions, towers 8 and 19 exhibit mutual incompatibility, towers 21 and 25 share mutual constraints, towers 14 and 28 experience interference patterns, towers 1 and 8 demonstrate conflict interactions, towers 10 and 12 exhibit mutual incompatibility, towers 17 and 22 share mutual constraints, towers 2 and 9 experience interference patterns, towers 4 and 16 demonstrate conflict interactions, towers 7 and 20 exhibit mutual incompatibility, towers 11 and 24 share mutual constraints, towers 19 and 29 experience interference patterns. Each tower infrastructure component must be allocated exactly one frequency assignment, represented by a positive integer designation corresponding to a specific spectral band allocation. The initiative's optimization methodology seeks to determine the minimal cardinality set of distinct frequency assignments that satisfies all conflict relationship constraints while maximizing spectral utilization efficiency and maintaining optimal network performance characteristics.",
  "solution_format_description": "Print the following fields: - tower_frequencies: frequency assignment for each tower. - num_frequencies: total number of different frequencies used.",
  "structured_data": {
    "num_towers": 30,
    "num_conflict_pairs": 113,
    "conflict_pairs": [
      [1, 2], [1, 3], [1, 4], [2, 3], [2, 4], [3, 4],
      [1, 5], [2, 6], [3, 7], [4, 8], [5, 6], [6, 7], [5, 7], [6, 8],
      [9, 10], [10, 11], [11, 9], [9, 12], [10, 12], [11, 12],
      [12, 13], [13, 14], [12, 14],
      [15, 9], [15, 14], [15, 8], [15, 7], [9, 14], [9, 8], [9, 7], [14, 8], [14, 7], [8, 7],
      [16, 17], [16, 18], [17, 18], [16, 19], [16, 20], [16, 21], [17, 19], [17, 20], [17, 21],
      [18, 19], [18, 20], [18, 21], [19, 20], [19, 21], [20, 21],
      [22, 16], [22, 21], [22, 6], [22, 14], [16, 21], [16, 6], [16, 14], [21, 6], [21, 14], [6, 14],
      [23, 24], [23, 25], [23, 26], [23, 27], [23, 2], [23, 1], [23, 3], [23, 4], [23, 5],
      [24, 25], [24, 26], [24, 27], [24, 28], [24, 29], [24, 30],
      [25, 26], [25, 27], [25, 28], [25, 29], [25, 30],
      [26, 27], [26, 28], [26, 29], [26, 30],
      [27, 28], [27, 29], [27, 30], [28, 29], [28, 30], [29, 30],
      [15, 23], [22, 27], [24, 28], [25, 29], [26, 30],
      [1, 17], [5, 9], [9, 13], [13, 17], [4, 19], [11, 26], [18, 30],
      [1, 6], [2, 7], [3, 8], [5, 8], [10, 15], [12, 15],
      [3, 12], [8, 19], [21, 25], [14, 28], [1, 8], [10, 12], [17, 22],
      [2, 9], [4, 16], [7, 20], [11, 24], [19, 29]
    ]
  },
  "reference_solution": {
    "tower_frequencies": [5, 4, 6, 7, 7, 3, 1, 4, 3, 6, 2, 1, 4, 2, 5, 4, 6, 7, 2, 3, 1, 7, 2, 7, 3, 5, 1, 4, 6, 2],
    "num_frequencies": 7
  },
  "solver_code": "from cpmpy import *\nimport json\n\nnum_towers = 30\nconflict_pairs = [\n    [1, 2], [1, 3], [1, 4], [2, 3], [2, 4], [3, 4],\n    [1, 5], [2, 6], [3, 7], [4, 8], [5, 6], [6, 7], [5, 7], [6, 8],\n    [9, 10], [10, 11], [11, 9], [9, 12], [10, 12], [11, 12],\n    [12, 13], [13, 14], [12, 14],\n    [15, 9], [15, 14], [15, 8], [15, 7], [9, 14], [9, 8], [9, 7], [14, 8], [14, 7], [8, 7],\n    [16, 17], [16, 18], [17, 18], [16, 19], [16, 20], [16, 21], [17, 19], [17, 20], [17, 21],\n    [18, 19], [18, 20], [18, 21], [19, 20], [19, 21], [20, 21],\n    [22, 16], [22, 21], [22, 6], [22, 14], [16, 21], [16, 6], [16, 14], [21, 6], [21, 14], [6, 14],\n    [23, 24], [23, 25], [23, 26], [23, 27], [23, 2], [23, 1], [23, 3], [23, 4], [23, 5],\n    [24, 25], [24, 26], [24, 27], [24, 28], [24, 29], [24, 30],\n    [25, 26], [25, 27], [25, 28], [25, 29], [25, 30],\n    [26, 27], [26, 28], [26, 29], [26, 30],\n    [27, 28], [27, 29], [27, 30], [28, 29], [28, 30], [29, 30],\n    [15, 23], [22, 27], [24, 28], [25, 29], [26, 30],\n    [1, 17], [5, 9], [9, 13], [13, 17], [4, 19], [11, 26], [18, 30],\n    [1, 6], [2, 7], [3, 8], [5, 8], [10, 15], [12, 15],\n    [3, 12], [8, 19], [21, 25], [14, 28], [1, 8], [10, 12], [17, 22],\n    [2, 9], [4, 16], [7, 20], [11, 24], [19, 29]\n]\n\nmodel = Model()\ntower_frequencies = intvar(1, num_towers, shape=num_towers)\n\nfor u, v in conflict_pairs:\n    model += tower_frequencies[u-1] != tower_frequencies[v-1]\n\nnum_frequencies = intvar(1, num_towers)\nfor i in range(num_towers):\n    model += num_frequencies >= tower_frequencies[i]\nmodel.minimize(num_frequencies)\n\nif model.solve():\n    result = {\n        \"tower_frequencies\": [int(tower_frequencies[i].value()) for i in range(num_towers)],\n        \"num_frequencies\": int(num_frequencies.value())\n    }\n    print(json.dumps(result))\nelse:\n    print(\"No solution found\")",
  "evaluation_function": "def evaluate(candidate_solution, structured_data, reference_solution):\n    import json\n    \n    try:\n        solution = json.loads(candidate_solution) if isinstance(candidate_solution, str) else candidate_solution\n    except:\n        return {\"is_valid\": False, \"validation_errors\": [\"Invalid JSON format\"], \"optimality_score\": 0.0}\n    \n    required_fields = [\"tower_frequencies\", \"num_frequencies\"]\n    missing = [f for f in required_fields if solution is None or f not in solution]\n    if missing:\n        return {\"is_valid\": False, \"validation_errors\": [f\"Missing fields: {missing}\"], \"optimality_score\": 0.0}\n    \n    try:\n        tower_frequencies = solution[\"tower_frequencies\"]\n        num_frequencies = solution[\"num_frequencies\"]\n        num_towers = structured_data[\"num_towers\"]\n        conflict_pairs = structured_data[\"conflict_pairs\"]\n        errors = []\n        \n        if len(tower_frequencies) != num_towers:\n            errors.append(f\"tower_frequencies length mismatch: expected {num_towers}, got {len(tower_frequencies)}\")\n        \n        for i, freq in enumerate(tower_frequencies):\n            if not isinstance(freq, int) or freq < 1:\n                errors.append(f\"Invalid frequency for tower {i+1}: {freq}. Frequencies must be positive integers.\")\n        \n        for u, v in conflict_pairs:\n            if 1 <= u <= num_towers and 1 <= v <= num_towers:\n                if tower_frequencies[u-1] == tower_frequencies[v-1]:\n                    errors.append(f\"Conflicting towers {u} and {v} share the same frequency {tower_frequencies[u-1]}\")\n        \n        if len(tower_frequencies) > 0:\n            actual = set(tower_frequencies)\n            actual_num = len(actual)\n            if num_frequencies != actual_num:\n                errors.append(f\"Frequency count inconsistency: declared {num_frequencies}, actual {actual_num}\")\n        \n        if len(errors) == 0:\n            optimal = reference_solution[\"num_frequencies\"]\n            if optimal == 0:\n                optimality_score = 1.0 if num_frequencies == 0 else 0.0\n            else:\n                gap = abs(optimal - num_frequencies) / abs(optimal)\n                optimality_score = max(0, 1 - gap)\n        else:\n            optimality_score = 0.0\n        \n        return {\n            \"is_valid\": len(errors) == 0,\n            \"validation_errors\": errors,\n            \"optimality_score\": optimality_score\n        }\n        \n    except Exception:\n        return {\"is_valid\": False, \"validation_errors\": [\"Format error in solution data\"], \"optimality_score\": 0.0}"
}
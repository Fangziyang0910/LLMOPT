{
  "problem_id": "quadratic_knapsack_with_conflict_graphs_002",
  "metadata": {
    "problem_type": "Quadratic Knapsack Problem with Conflict Graphs",
    "difficulty": "medium"
  },
  "problem_description": "Dr. Chen is planning a research project for a pharmaceutical company with a total budget of $100 million and needs to select the most promising combination of drug development trials, where each trial can either be fully funded or not funded at all. The available trials have the following individual expected profits and costs (in million dollars): 1. Alpha antibody trial with profit 18 and cost 10; 2. Beta vaccine trial with profit 32 and cost 18; 3. Gamma antiviral trial with profit 24 and cost 14; 4. Delta diagnostic test trial with profit 38 and cost 22; 5. Epsilon gene therapy trial with profit 28 and cost 16; 6. Zeta monoclonal antibody trial with profit 45 and cost 26; 7. Eta small molecule trial with profit 35 and cost 20; 8. Theta RNA therapy trial with profit 42 and cost 24; 9. Iota peptide trial with profit 22 and cost 12; 10. Kappa CRISPR trial with profit 48 and cost 28; 11. Lambda immunotherapy trial with profit 20 and cost 11; 12. Mu cell therapy trial with profit 30 and cost 17; 13. Nu proteomics trial with profit 40 and cost 23; 14. Xi biomarker trial with profit 52 and cost 30; 15. Omicron microbiome trial with profit 26 and cost 15; 16. Pi nanomedicine trial with profit 36 and cost 21; 17. Rho metabolomics trial with profit 33 and cost 19; 18. Sigma personalized medicine trial with profit 56 and cost 32; 19. Tau epigenetics trial with profit 25 and cost 14; 20. Upsilon AI drug discovery trial with profit 50 and cost 29; 21. Phi digital therapeutics trial with profit 31 and cost 18; 22. Chi synthetic biology trial with profit 58 and cost 33; 23. Psi regenerative medicine trial with profit 39 and cost 22; 24. Omega longevity trial with profit 62 and cost 35. When certain trials are selected together, they generate additional synergy profits (in million dollars): Alpha-Beta (6), Beta-Gamma (7), Alpha-Delta (8), Delta-Epsilon (11), Beta-Zeta (12), Alpha-Eta (4), Beta-Theta (9), Gamma-Iota (6), Zeta-Kappa (8), Alpha-Lambda (3), Lambda-Mu (5), Lambda-Xi (4), Mu-Nu (6), Nu-Xi (11), Xi-Sigma (13), Sigma-Chi (17), Tau-Upsilon (6), Upsilon-Chi (14), Chi-Omega (10). However, some trials are mutually incompatible and cannot be selected together due to specific scientific constraints: Alpha and Gamma target the same disease pathway, Beta and Eta require overlapping laboratory facilities, Delta and Iota share patient populations, Epsilon and Kappa use conflicting delivery mechanisms, Zeta and Theta have incompatible manufacturing processes, Lambda and Omicron compete for the same research team, Mu and Rho require similar clinical trial sites, Nu and Tau share proprietary data, Xi and Chi have conflicting regulatory pathways, Sigma and Upsilon face intellectual property conflicts, Psi and Omega compete for the same patient cohorts, Alpha and Mu require similar biomarker assays, Gamma and Pi have overlapping target proteins, Epsilon and Rho use the same delivery vectors, Eta and Psi share clinical trial infrastructure, Iota and Chi have conflicting dosing regimens, Kappa and Xi compete for manufacturing capacity, Omicron and Tau have incompatible trial designs, Pi and Chi face overlapping patient recruitment. How should Dr. Chen choose which trials to fund to maximize total profit while staying within the $100 million budget and respecting all compatibility constraints?",  
  "solution_format_description": "Print the following fields: - selected_trials: selection status for each trial. - total_profit: total expected profit. - total_cost: total development cost.",
  "structured_data": {
    "trials": [
      [18, 10],
      [32, 18],
      [24, 14],
      [38, 22],
      [28, 16],
      [45, 26],
      [35, 20],
      [42, 24],
      [22, 12],
      [48, 28],
      [20, 11],
      [30, 17],
      [40, 23],
      [52, 30],
      [26, 15],
      [36, 21],
      [33, 19],
      [56, 32],
      [25, 14],
      [50, 29],
      [31, 18],
      [58, 33],
      [39, 22],
      [62, 35]
    ],
    "synergy_profits": [
      [0, 1, 6],
      [1, 2, 7],
      [0, 3, 8],
      [3, 4, 11],
      [1, 5, 12],
      [0, 6, 4],
      [1, 7, 9],
      [2, 8, 6],
      [5, 9, 8],
      [0, 10, 3],
      [10, 11, 5],
      [10, 13, 4],
      [11, 12, 6],
      [12, 13, 11],
      [13, 17, 13],
      [17, 21, 17],
      [18, 19, 6],
      [19, 21, 14],
      [21, 23, 10]
    ],
    "conflicts": [
      [0, 2], 
      [1, 6], 
      [3, 8], 
      [4, 9], 
      [5, 7], 
      [10, 14], 
      [11, 16], 
      [12, 18], 
      [13, 21], 
      [17, 19], 
      [22, 23], 
      [0, 11], 
      [2, 15], 
      [4, 16], 
      [6, 22], 
      [8, 21], 
      [9, 13], 
      [14, 18], 
      [15, 21]
    ],
    "budget_limit": 100
  },
  "reference_solution": {
    "selected_trials": [1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    "total_profit": 204,
    "total_cost": 100
  },
  "solver_code": "",
  "evaluation_function": "def evaluate(candidate_solution, structured_data, reference_solution):\n    import json\n    \n    try:\n        solution = json.loads(candidate_solution) if isinstance(candidate_solution, str) else candidate_solution\n    except:\n        return {\"is_valid\": False, \"validation_errors\": [\"Invalid JSON format\"], \"optimality_score\": 0.0}\n    \n    required_fields = [\"selected_trials\", \"total_profit\", \"total_cost\"]\n    missing = [f for f in required_fields if solution is None or f not in solution]\n    if missing:\n        return {\"is_valid\": False, \"validation_errors\": [f\"Missing fields: {missing}\"], \"optimality_score\": 0.0}\n    \n    try:\n        selected_trials = solution[\"selected_trials\"]\n        total_cost = solution[\"total_cost\"]\n        total_profit = solution[\"total_profit\"]\n        trials = structured_data[\"trials\"]\n        synergy_profits = structured_data[\"synergy_profits\"]\n        conflicts = structured_data[\"conflicts\"]\n        budget_limit = structured_data[\"budget_limit\"]\n        errors = []\n        \n        if len(selected_trials) != len(trials):\n            errors.append(f\"Array length mismatch: expected {len(trials)}, got {len(selected_trials)}\")\n        \n        if total_cost > budget_limit:\n            errors.append(f\"Budget constraint violated: {total_cost} > {budget_limit}\")\n        \n        for conflict in conflicts:\n            i, j = conflict\n            if selected_trials[i] == 1 and selected_trials[j] == 1:\n                errors.append(f\"Conflict constraint violated: trials {i} and {j} both selected\")\n        \n        calc_cost = sum(trials[i][1] * selected_trials[i] for i in range(len(trials)))\n        calc_base_profit = sum(trials[i][0] * selected_trials[i] for i in range(len(trials)))\n        \n        calc_synergy_profit = 0\n        for synergy in synergy_profits:\n            i, j, value = synergy\n            if selected_trials[i] and selected_trials[j]:\n                calc_synergy_profit += value\n        \n        calc_total_profit = calc_base_profit + calc_synergy_profit\n        \n        if abs(calc_cost - total_cost) > 1e-6:\n            errors.append(f\"Cost inconsistency: calculated {calc_cost}, declared {total_cost}\")\n        \n        if abs(calc_total_profit - total_profit) > 1e-6:\n            errors.append(f\"Profit inconsistency: calculated {calc_total_profit}, declared {total_profit}\")\n        \n        if len(errors) > 0:\n            optimality_score = 0.0\n        else:\n            optimal_profit = reference_solution[\"total_profit\"]\n            if optimal_profit == 0:\n                optimality_score = 1.0 if total_profit == 0 else 0.0\n            else:\n                gap = abs(optimal_profit - total_profit) / abs(optimal_profit)\n                optimality_score = max(0, 1 - gap)\n        \n        return {\n            \"is_valid\": len(errors) == 0,\n            \"validation_errors\": errors,\n            \"optimality_score\": optimality_score\n        }\n        \n    except Exception as e:\n        return {\"is_valid\": False, \"validation_errors\": [\"Format error in solution data\"], \"optimality_score\": 0.0}"
}
{
  "problem_id": "travelling_thief_problem_003",
  "metadata": {
    "problem_type": "Travelling Thief Problem",
    "difficulty": "hard"
  },
  "problem_description": "An art recovery team is setting out from their headquarters to visit ten storage facilities across the region. The headquarters serves as the starting point at coordinates (0, 0), with all distances measured in kilometers. The team must start from headquarters, visit each facility exactly once, and then return to headquarters. All locations can be reached by straight-line travel. The team's vehicle can carry up to 60 kg of artifacts. The vehicle speed changes linearly with the weight they're carrying - moving at 60.0 km/h when completely unburdened, and slowing down proportionally as more weight is added, reaching exactly 30.0 km/h when carrying the full 60 kg capacity. The team has to pay travel expenses of 1 dollars for each hour they spend on the road, which covers their fuel, maintenance, accommodation, and equipment costs during the journey. The storage facilities and their available artifacts are distributed as follows: Facility 1 located at coordinates (34, 56) contains four artifacts including one valued at 25 dollars and weighing 3 kg, another valued at 48 dollars and weighing 6 kg, a third valued at 67 dollars and weighing 8 kg, and a fourth valued at 34 dollars and weighing 4 kg; Facility 2 at coordinates (178, 234) houses four artifacts including pieces worth 56 dollars and weighing 7 kg, 78 dollars and weighing 9 kg, 23 dollars and weighing 3 kg, and 89 dollars and weighing 10 kg; Facility 3 at coordinates (267, 123) stores four artifacts with values of 45 dollars and weighing 5 kg, 67 dollars and weighing 7 kg, 34 dollars and weighing 4 kg, and 78 dollars and weighing 8 kg; Facility 4 at coordinates (89, 45) holds four artifacts worth 56 dollars and weighing 6 kg, 23 dollars and weighing 3 kg, 89 dollars and weighing 9 kg, and 45 dollars and weighing 5 kg; Facility 5 at coordinates (156, 189) contains four artifacts valued at 67 dollars and weighing 7 kg, 34 dollars and weighing 4 kg, 78 dollars and weighing 8 kg, and 56 dollars and weighing 6 kg; Facility 6 at coordinates (234, 67) stores four artifacts worth 23 dollars and weighing 3 kg, 89 dollars and weighing 9 kg, 45 dollars and weighing 5 kg, and 67 dollars and weighing 7 kg; Facility 7 at coordinates (45, 178) houses four artifacts with values of 34 dollars and weighing 4 kg, 78 dollars and weighing 8 kg, 56 dollars and weighing 6 kg, and 23 dollars and weighing 3 kg; Facility 8 at coordinates (123, 267) contains four artifacts including pieces worth 89 dollars and weighing 9 kg, 45 dollars and weighing 5 kg, 67 dollars and weighing 7 kg, and 34 dollars and weighing 4 kg; Facility 9 at coordinates (189, 89) holds four artifacts valued at 78 dollars and weighing 8 kg, 56 dollars and weighing 6 kg, 23 dollars and weighing 3 kg, and 89 dollars and weighing 9 kg; Facility 10 at coordinates (267, 156) stores four artifacts worth 45 dollars and weighing 5 kg, 67 dollars and weighing 7 kg, 34 dollars and weighing 4 kg, and 78 dollars and weighing 8 kg. Artifacts can only be collected from their original facilities, and each artifact can either be taken or left behind (no partial selections). The total weight of collected artifacts must not exceed 60 kg. Which artifacts should the art recovery team collect and which route should they take to maximize their total profit after accounting for travel expenses?",
  "solution_format_description": "Print the following fields: - route: complete route visiting all facilities. - collected_artifacts: selected artifacts. - total_weight: total weight of collected artifacts. - total_time: total travel time. - total_profit: total artifact value minus travel cost.",
  "structured_data": {
    "storage_facilities": [
      [34, 56],
      [178, 234],
      [267, 123],
      [89, 45],
      [156, 189],
      [234, 67],
      [45, 178],
      [123, 267],
      [189, 89],
      [267, 156]
    ],
    "artifacts": [
      [25, 3, 1],
      [48, 6, 1],
      [67, 8, 1],
      [34, 4, 1],
      [56, 7, 2],
      [78, 9, 2],
      [23, 3, 2],
      [89, 10, 2],
      [45, 5, 3],
      [67, 7, 3],
      [34, 4, 3],
      [78, 8, 3],
      [56, 6, 4],
      [23, 3, 4],
      [89, 9, 4],
      [45, 5, 4],
      [67, 7, 5],
      [34, 4, 5],
      [78, 8, 5],
      [56, 6, 5],
      [23, 3, 6],
      [89, 9, 6],
      [45, 5, 6],
      [67, 7, 6],
      [34, 4, 7],
      [78, 8, 7],
      [56, 6, 7],
      [23, 3, 7],
      [89, 9, 8],
      [45, 5, 8],
      [67, 7, 8],
      [34, 4, 8],
      [78, 8, 9],
      [56, 6, 9],
      [23, 3, 9],
      [89, 9, 9],
      [45, 5, 10],
      [67, 7, 10],
      [34, 4, 10],
      [78, 8, 10]
    ],
    "vehicle_capacity": 60,
    "min_speed": 30,
    "max_speed": 60,
    "travel_cost_per_hour": 1
  },
  "reference_solution": {
    "route": [0, 1, 7, 8, 2, 5, 10, 3, 6, 9, 4, 0],
    "collected_artifacts": [12, 15, 22, 29, 33, 36, 40],
    "total_weight": 60,
    "total_time": 18.9158,
    "total_profit": 571.0842
  },
  "solver_code": "",
  "evaluation_function": "def evaluate(candidate_solution, structured_data, reference_solution):\n    import json\n    \n    try:\n        solution = json.loads(candidate_solution) if isinstance(candidate_solution, str) else candidate_solution\n    except:\n        return {\"is_valid\": False, \"validation_errors\": [\"Invalid JSON format\"], \"optimality_score\": 0.0}\n    \n    required_fields = [\"route\", \"collected_artifacts\", \"total_weight\", \"total_time\", \"total_profit\"]\n    missing = [f for f in required_fields if solution is None or f not in solution]\n    if missing:\n        return {\"is_valid\": False, \"validation_errors\": [f\"Missing fields: {missing}\"], \"optimality_score\": 0.0}\n    \n    try:\n        route = solution[\"route\"]\n        collected_artifacts = solution[\"collected_artifacts\"]\n        total_weight = solution[\"total_weight\"]\n        \n        storage_facilities = structured_data[\"storage_facilities\"]\n        artifacts = structured_data[\"artifacts\"]\n        vehicle_capacity = structured_data[\"vehicle_capacity\"]\n        \n        errors = []\n        \n        if len(route) != 12:\n            errors.append(f\"Route must have 12 positions (start, 10 facilities, end), got {len(route)}\")\n        \n        if route[0] != 0 or route[-1] != 0:\n            errors.append(\"Route must start and end at headquarters (0)\")\n        \n        visited_facilities = route[1:-1]\n        if set(visited_facilities) != set(range(1, 11)):\n            errors.append(\"Route must visit each facility exactly once\")\n        \n        if total_weight > vehicle_capacity:\n            errors.append(f\"Weight constraint violated: {total_weight} > {vehicle_capacity}\")\n        \n        valid_artifact_ids = set(range(1, len(artifacts) + 1))\n        for artifact_id in collected_artifacts:\n            if artifact_id not in valid_artifact_ids:\n                errors.append(f\"Invalid artifact ID: {artifact_id}\")\n        \n        for artifact_id in collected_artifacts:\n            artifact_facility = artifacts[artifact_id - 1][2]\n            if artifact_facility not in visited_facilities:\n                errors.append(f\"Artifact {artifact_id} from facility {artifact_facility} is collected but facility {artifact_facility} is not visited\")\n        \n        if len(errors) == 0:\n            if \"total_profit\" in solution:\n                optimal_value = reference_solution[\"total_profit\"]\n                candidate_value = solution[\"total_profit\"]\n                \n                if optimal_value == 0:\n                    optimality_score = 1.0 if candidate_value == 0 else 0.0\n                else:\n                    gap = abs(optimal_value - candidate_value) / abs(optimal_value)\n                    optimality_score = max(0, 1 - gap)\n            else:\n                optimality_score = 0.0\n        else:\n            optimality_score = 0.0\n        \n        return {\n            \"is_valid\": len(errors) == 0,\n            \"validation_errors\": errors,\n            \"optimality_score\": optimality_score\n        }\n        \n    except Exception as e:\n        return {\"is_valid\": False, \"validation_errors\": [\"Format error in solution data\"], \"optimality_score\": 0.0}\n"
}
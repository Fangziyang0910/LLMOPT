{
  "problem_id": "maximum_flow_001",
  "metadata": {
    "problem_type": "Maximum Flow Problem",
    "difficulty": "simple"
  },
  "problem_description": "A water distribution system consists of 10 pumping stations including a main water source, 8 intermediate stations, and a final distribution point, all connected by 15 directional pipelines with different flow capacities where water can only flow in the specified direction through each pipeline. The water distribution system is structured as follows: From the water source, water flows to station 1 with a pipeline capacity of 10 cubic meters per minute and to station 2 with a pipeline capacity of 8 cubic meters per minute. In the next layer, station 1 connects to station 3 with a pipeline capacity of 5 cubic meters per minute and to station 4 with a pipeline capacity of 7 cubic meters per minute. Station 2 connects to station 4 with a pipeline capacity of 6 cubic meters per minute and to station 5 with a pipeline capacity of 9 cubic meters per minute. In the following layer, station 3 connects to station 6 with a pipeline capacity of 8 cubic meters per minute. Station 4 connects to station 6 with a pipeline capacity of 4 cubic meters per minute and to station 7 with a pipeline capacity of 10 cubic meters per minute. Station 5 connects to station 7 with a pipeline capacity of 7 cubic meters per minute and to station 8 with a pipeline capacity of 5 cubic meters per minute. Finally, station 6 connects to the distribution point with a pipeline capacity of 12 cubic meters per minute, station 7 connects to the distribution point with a pipeline capacity of 9 cubic meters per minute, and station 8 connects to station 7 with a pipeline capacity of 6 cubic meters per minute and to the distribution point with a pipeline capacity of 8 cubic meters per minute. The operator needs to determine the maximum amount of water that can be transported from the main water source to the final distribution point through the network while respecting flow conservation at each intermediate station and pipeline capacity limits.",  
  "solution_format_description": "Print the following fields: - max_flow: maximum water flow from source to destination. - flow_distribution: flow amount for each pipeline.",  
  "structured_data": {
    "num_stations": 10,
    "pipelines": [
      [0, 1, 10],
      [0, 2, 8],
      [1, 3, 5],
      [1, 4, 7],
      [2, 4, 6],
      [2, 5, 9],
      [3, 6, 8],
      [4, 6, 4],
      [4, 7, 10],
      [5, 7, 7],
      [6, 9, 12],
      [7, 9, 9],
      [5, 8, 5],
      [8, 7, 6],
      [8, 9, 8]
    ]
  },
  "reference_solution": {
    "max_flow": 18,
    "flow_distribution": [[0, 1, 10], [0, 2, 8], [1, 3, 5], [1, 4, 5], [2, 4, 6], [2, 5, 2], [3, 6, 5], [4, 6, 4], [4, 7, 7], [5, 7, 2], [6, 9, 9], [7, 9, 9]]
  },
  "solver_code": "",
  "evaluation_function": "def evaluate(candidate_solution, structured_data, reference_solution):\n    import json\n    \n    try:\n        solution = json.loads(candidate_solution) if isinstance(candidate_solution, str) else candidate_solution\n    except:\n        return {\"is_valid\": False, \"validation_errors\": [\"Invalid JSON format\"], \"optimality_score\": 0.0}\n    \n    required_fields = [\"max_flow\", \"flow_distribution\"]\n    missing = [f for f in required_fields if solution is None or f not in solution]\n    if missing:\n        return {\"is_valid\": False, \"validation_errors\": [f\"Missing fields: {missing}\"], \"optimality_score\": 0.0}\n    \n    try:\n        max_flow = solution[\"max_flow\"]\n        flow_distribution = solution[\"flow_distribution\"]\n        pipelines = structured_data[\"pipelines\"]\n        num_stations = structured_data[\"num_stations\"]\n        source = 0\n        sink = 9\n        \n        errors = []\n        \n        capacity = [[0] * num_stations for _ in range(num_stations)]\n        for pipeline in pipelines:\n            from_station, to_station, flow_capacity = pipeline\n            capacity[from_station][to_station] = flow_capacity\n        \n        inflow = [0] * num_stations\n        outflow = [0] * num_stations\n        \n        for flow_item in flow_distribution:\n            from_station, to_station, flow_amount = flow_item\n            \n            if flow_amount > capacity[from_station][to_station]:\n                errors.append(f\"Flow {flow_amount} exceeds capacity {capacity[from_station][to_station]} on pipeline {from_station}->{to_station}\")\n            \n            if flow_amount < 0:\n                errors.append(f\"Negative flow {flow_amount} on pipeline {from_station}->{to_station}\")\n            \n            outflow[from_station] += flow_amount\n            inflow[to_station] += flow_amount\n        \n        if outflow[source] != max_flow:\n            errors.append(f\"Source outflow {outflow[source]} != max_flow {max_flow}\")\n        \n        if inflow[sink] != max_flow:\n            errors.append(f\"Sink inflow {inflow[sink]} != max_flow {max_flow}\")\n        \n        for i in range(num_stations):\n            if i != source and i != sink:\n                if abs(inflow[i] - outflow[i]) > 1e-6:\n                    errors.append(f\"Flow conservation violation at node {i}: inflow {inflow[i]} != outflow {outflow[i]}\")\n        \n        is_valid = len(errors) == 0\n        \n        if not is_valid:\n            return {\"is_valid\": False, \"validation_errors\": errors, \"optimality_score\": 0.0}\n        \n        optimal_flow = reference_solution[\"max_flow\"]\n        if optimal_flow == 0:\n            optimality_score = 1.0 if max_flow == 0 else 0.0\n        else:\n            gap = abs(optimal_flow - max_flow) / abs(optimal_flow)\n            optimality_score = max(0, 1 - gap)\n        \n        return {\n            \"is_valid\": is_valid,\n            \"validation_errors\": errors,\n            \"optimality_score\": optimality_score\n        }\n        \n    except Exception as e:\n        return {\"is_valid\": False, \"validation_errors\": [\"Format error in solution data\"], \"optimality_score\": 0.0}"
}
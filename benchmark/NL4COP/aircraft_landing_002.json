{
  "problem_id": "aircraft_landing_002",
  "metadata": {
    "problem_type": "Aircraft Landing Scheduling Problem",
    "difficulty": "medium"
  },
  "problem_description": "A major international airport's air traffic control center must coordinate the landing schedule for 20 incoming aircraft across 3 available runways during a busy evening period. Each aircraft has specific operational requirements and timing constraints that must be carefully managed to ensure safe and efficient operations. The objective is to minimize total delay penalties while maintaining all safety standards.\n\nAircraft details and scheduling requirements:\n1. Flight BA205: earliest landing 75 minutes, target 82 minutes, latest 486 minutes, penalty 30 per minute early/late\n2. Flight LH891: earliest landing 157 minutes, target 197 minutes, latest 628 minutes, penalty 10 per minute early/late\n3. Flight AF442: earliest landing 134 minutes, target 160 minutes, latest 561 minutes, penalty 10 per minute early/late\n4. Flight KL358: earliest landing 103 minutes, target 117 minutes, latest 565 minutes, penalty 30 per minute early/late\n5. Flight EK007: earliest landing 201 minutes, target 261 minutes, latest 735 minutes, penalty 10 per minute early/late\n6. Flight QF123: earliest landing 95 minutes, target 106 minutes, latest 524 minutes, penalty 30 per minute early/late\n7. Flight SQ456: earliest landing 185 minutes, target 229 minutes, latest 664 minutes, penalty 10 per minute early/late\n8. Flight CX789: earliest landing 98 minutes, target 108 minutes, latest 523 minutes, penalty 30 per minute early/late\n9. Flight JL012: earliest landing 117 minutes, target 132 minutes, latest 578 minutes, penalty 30 per minute early/late\n10. Flight TG345: earliest landing 117 minutes, target 130 minutes, latest 569 minutes, penalty 30 per minute early/late\n11. Flight NH678: earliest landing 132 minutes, target 149 minutes, latest 615 minutes, penalty 30 per minute early/late\n12. Flight OZ901: earliest landing 114 minutes, target 126 minutes, latest 551 minutes, penalty 30 per minute early/late\n13. Flight AC234: earliest landing 261 minutes, target 336 minutes, latest 834 minutes, penalty 10 per minute early/late\n14. Flight WF567: earliest landing 250 minutes, target 316 minutes, latest 790 minutes, penalty 10 per minute early/late\n15. Flight UA890: earliest landing 214 minutes, target 258 minutes, latest 688 minutes, penalty 10 per minute early/late\n16. Flight DL123: earliest landing 310 minutes, target 409 minutes, latest 967 minutes, penalty 10 per minute early/late\n17. Flight AA456: earliest landing 269 minutes, target 338 minutes, latest 818 minutes, penalty 10 per minute early/late\n18. Flight VS789: earliest landing 237 minutes, target 287 minutes, latest 726 minutes, penalty 10 per minute early/late\n19. Flight OS012: earliest landing 144 minutes, target 160 minutes, latest 607 minutes, penalty 30 per minute early/late\n20. Flight LX345: earliest landing 151 minutes, target 169 minutes, latest 624 minutes, penalty 30 per minute early/late\n\nSafety separation requirements: Aircraft must maintain minimum time gaps between landings when using the same runway. The required separation depends on aircraft type combinations: large aircraft (flights 1-2, 5, 7, 13-18) need 3 minutes separation from each other, smaller aircraft (flights 3-4, 6, 8-12, 19-20) need 8 minutes separation between each other, while mixed pairs require 15 minutes separation regardless of order. Aircraft landing on different runways can operate simultaneously without separation constraints.\n\nThe air traffic controller must determine the optimal landing time and runway assignment for each aircraft to minimize the total penalty cost while ensuring all timing windows and safety separation requirements are satisfied.",
  "solution_format_description": "Print the following fields: - landing_times: landing time for each aircraft. - runways: runway assignment for each aircraft. - total_penalty: sum of early/late penalties.",
  "structured_data": {
    "num_aircraft": 20,
    "num_runways": 3,
    "flights": [
      [75, 82, 486, 30, 30],
      [157, 197, 628, 10, 10],
      [134, 160, 561, 10, 10],
      [103, 117, 565, 30, 30],
      [201, 261, 735, 10, 10],
      [95, 106, 524, 30, 30],
      [185, 229, 664, 10, 10],
      [98, 108, 523, 30, 30],
      [117, 132, 578, 30, 30],
      [117, 130, 569, 30, 30],
      [132, 149, 615, 30, 30],
      [114, 126, 551, 30, 30],
      [261, 336, 834, 10, 10],
      [250, 316, 790, 10, 10],
      [214, 258, 688, 10, 10],
      [310, 409, 967, 10, 10],
      [269, 338, 818, 10, 10],
      [237, 287, 726, 10, 10],
      [144, 160, 607, 30, 30],
      [151, 169, 624, 30, 30]
    ],
    "separation_matrix": [
      [99999, 15, 15, 8, 15, 8, 15, 8, 8, 8, 8, 8, 15, 15, 15, 15, 15, 15, 8, 8],
      [15, 99999, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 3, 3, 3, 3, 3, 15, 15],
      [15, 3, 99999, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 3, 3, 3, 3, 3, 15, 15],
      [8, 15, 15, 99999, 15, 8, 15, 8, 8, 8, 8, 8, 15, 15, 15, 15, 15, 15, 8, 8],
      [15, 3, 3, 15, 99999, 15, 3, 15, 15, 15, 15, 15, 3, 3, 3, 3, 3, 3, 15, 15],
      [8, 15, 15, 8, 15, 99999, 15, 8, 8, 8, 8, 8, 15, 15, 15, 15, 15, 15, 8, 8],
      [15, 3, 3, 15, 3, 15, 99999, 15, 15, 15, 15, 15, 3, 3, 3, 3, 3, 3, 15, 15],
      [8, 15, 15, 8, 15, 8, 15, 99999, 8, 8, 8, 8, 15, 15, 15, 15, 15, 15, 8, 8],
      [8, 15, 15, 8, 15, 8, 15, 8, 99999, 8, 8, 8, 15, 15, 15, 15, 15, 15, 8, 8],
      [8, 15, 15, 8, 15, 8, 15, 8, 8, 99999, 8, 8, 15, 15, 15, 15, 15, 15, 8, 8],
      [8, 15, 15, 8, 15, 8, 15, 8, 8, 8, 99999, 8, 15, 15, 15, 15, 15, 15, 8, 8],
      [8, 15, 15, 8, 15, 8, 15, 8, 8, 8, 8, 99999, 15, 15, 15, 15, 15, 15, 8, 8],
      [15, 3, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 99999, 3, 3, 3, 3, 3, 15, 15],
      [15, 3, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 99999, 3, 3, 3, 3, 15, 15],
      [15, 3, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 3, 99999, 3, 3, 3, 15, 15],
      [15, 3, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 3, 3, 99999, 3, 3, 15, 15],
      [15, 3, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 3, 3, 3, 99999, 3, 15, 15],
      [15, 3, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 3, 3, 3, 3, 99999, 15, 15],
      [8, 15, 15, 8, 15, 8, 15, 8, 8, 8, 8, 8, 15, 15, 15, 15, 15, 15, 99999, 8],
      [8, 15, 15, 8, 15, 8, 15, 8, 8, 8, 8, 8, 15, 15, 15, 15, 15, 15, 8, 99999]
    ]
  },
  "reference_solution": {
    "landing_times": [82, 197, 160, 117, 261, 106, 229, 108, 132, 130, 149, 126, 336, 316, 258, 409, 338, 287, 160, 169],
    "runways": [2, 2, 1, 2, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2],
    "total_penalty": 0
  },
  "solver_code": "from cpmpy import *\nimport json\n\nEARLIEST = 0\nTARGET = 1\nLATEST = 2\nEARLY_PENALTY = 3\nLATE_PENALTY = 4\n\nflights = [\n    [75, 82, 486, 30, 30],\n    [157, 197, 628, 10, 10],\n    [134, 160, 561, 10, 10],\n    [103, 117, 565, 30, 30],\n    [201, 261, 735, 10, 10],\n    [95, 106, 524, 30, 30],\n    [185, 229, 664, 10, 10],\n    [98, 108, 523, 30, 30],\n    [117, 132, 578, 30, 30],\n    [117, 130, 569, 30, 30],\n    [132, 149, 615, 30, 30],\n    [114, 126, 551, 30, 30],\n    [261, 336, 834, 10, 10],\n    [250, 316, 790, 10, 10],\n    [214, 258, 688, 10, 10],\n    [310, 409, 967, 10, 10],\n    [269, 338, 818, 10, 10],\n    [237, 287, 726, 10, 10],\n    [144, 160, 607, 30, 30],\n    [151, 169, 624, 30, 30]\n]\nseparation_matrix = [\n    [99999, 15, 15, 8, 15, 8, 15, 8, 8, 8, 8, 8, 15, 15, 15, 15, 15, 15, 8, 8],\n    [15, 99999, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 3, 3, 3, 3, 3, 15, 15],\n    [15, 3, 99999, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 3, 3, 3, 3, 3, 15, 15],\n    [8, 15, 15, 99999, 15, 8, 15, 8, 8, 8, 8, 8, 15, 15, 15, 15, 15, 15, 8, 8],\n    [15, 3, 3, 15, 99999, 15, 3, 15, 15, 15, 15, 15, 3, 3, 3, 3, 3, 3, 15, 15],\n    [8, 15, 15, 8, 15, 99999, 15, 8, 8, 8, 8, 8, 15, 15, 15, 15, 15, 15, 8, 8],\n    [15, 3, 3, 15, 3, 15, 99999, 15, 15, 15, 15, 15, 3, 3, 3, 3, 3, 3, 15, 15],\n    [8, 15, 15, 8, 15, 8, 15, 99999, 8, 8, 8, 8, 15, 15, 15, 15, 15, 15, 8, 8],\n    [8, 15, 15, 8, 15, 8, 15, 8, 99999, 8, 8, 8, 15, 15, 15, 15, 15, 15, 8, 8],\n    [8, 15, 15, 8, 15, 8, 15, 8, 8, 99999, 8, 8, 15, 15, 15, 15, 15, 15, 8, 8],\n    [8, 15, 15, 8, 15, 8, 15, 8, 8, 8, 99999, 8, 15, 15, 15, 15, 15, 15, 8, 8],\n    [8, 15, 15, 8, 15, 8, 15, 8, 8, 8, 8, 99999, 15, 15, 15, 15, 15, 15, 8, 8],\n    [15, 3, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 99999, 3, 3, 3, 3, 3, 15, 15],\n    [15, 3, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 99999, 3, 3, 3, 3, 15, 15],\n    [15, 3, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 3, 99999, 3, 3, 3, 15, 15],\n    [15, 3, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 3, 3, 99999, 3, 3, 15, 15],\n    [15, 3, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 3, 3, 3, 99999, 3, 15, 15],\n    [15, 3, 3, 15, 3, 15, 3, 15, 15, 15, 15, 15, 3, 3, 3, 3, 3, 99999, 15, 15],\n    [8, 15, 15, 8, 15, 8, 15, 8, 8, 8, 8, 8, 15, 15, 15, 15, 15, 15, 99999, 8],\n    [8, 15, 15, 8, 15, 8, 15, 8, 8, 8, 8, 8, 15, 15, 15, 15, 15, 15, 8, 99999]\n]\nnum_aircraft = 20\nnum_runways = 3\n\nmodel = Model()\nlanding_times = intvar(0, 1000, shape=num_aircraft)\nrunways = intvar(1, num_runways, shape=num_aircraft)\n\nfor i in range(num_aircraft):\n    model += landing_times[i] >= flights[i][EARLIEST]\n    model += landing_times[i] <= flights[i][LATEST]\n\nfor i in range(num_aircraft):\n    for j in range(num_aircraft):\n        if i != j:\n            model += ((runways[i] == runways[j]) & (landing_times[i] <= landing_times[j])).implies(\n                landing_times[j] - landing_times[i] >= separation_matrix[i][j]\n            )\n\npenalty_vars = intvar(0, 100000, shape=num_aircraft)\nfor i in range(num_aircraft):\n    target = flights[i][TARGET]\n    early_penalty = flights[i][EARLY_PENALTY]\n    late_penalty = flights[i][LATE_PENALTY]\n    early_cost = (target - landing_times[i]) * early_penalty\n    late_cost = (landing_times[i] - target) * late_penalty\n    model += penalty_vars[i] >= early_cost\n    model += penalty_vars[i] >= late_cost\n    model += penalty_vars[i] >= 0\n\ntotal_penalty = sum(penalty_vars)\nmodel.minimize(total_penalty)\n\nif model.solve():\n    result = {\n        \"landing_times\": [int(landing_times[i].value()) for i in range(num_aircraft)],\n        \"runways\": [int(runways[i].value()) for i in range(num_aircraft)],\n        \"total_penalty\": int(total_penalty.value())\n    }\n    print(json.dumps(result))\nelse:\n    print(json.dumps({\"error\": \"No solution found\"}))",
  "evaluation_function": "def evaluate(candidate_solution, structured_data, reference_solution):\n    import json\n    \n    EARLIEST = 0\n    TARGET = 1\n    LATEST = 2\n    EARLY_PENALTY = 3\n    LATE_PENALTY = 4\n    \n    try:\n        solution = json.loads(candidate_solution) if isinstance(candidate_solution, str) else candidate_solution\n    except:\n        return {\"is_valid\": False, \"validation_errors\": [\"Invalid JSON format\"], \"optimality_score\": 0.0}\n    \n    required_fields = [\"landing_times\", \"runways\", \"total_penalty\"]\n    missing = [f for f in required_fields if solution is None or f not in solution]\n    if missing:\n        return {\"is_valid\": False, \"validation_errors\": [f\"Missing fields: {missing}\"], \"optimality_score\": 0.0}\n    \n    try:\n        landing_times = solution[\"landing_times\"]\n        runways = solution[\"runways\"]\n        total_penalty = solution[\"total_penalty\"]\n        \n        num_aircraft = structured_data[\"num_aircraft\"]\n        num_runways = structured_data[\"num_runways\"]\n        flights = structured_data[\"flights\"]\n        separation_matrix = structured_data[\"separation_matrix\"]\n        errors = []\n        \n        if len(landing_times) != num_aircraft:\n            errors.append(f\"landing_times length mismatch: expected {num_aircraft}, got {len(landing_times)}\")\n        \n        if len(runways) != num_aircraft:\n            errors.append(f\"runways length mismatch: expected {num_aircraft}, got {len(runways)}\")\n        \n        if errors:\n            return {\"is_valid\": False, \"validation_errors\": errors, \"optimality_score\": 0.0}\n        \n        for i in range(num_aircraft):\n            landing_time = landing_times[i]\n            earliest = flights[i][EARLIEST]\n            latest = flights[i][LATEST]\n            if landing_time < earliest or landing_time > latest:\n                errors.append(f\"Flight {i}: landing time {landing_time} outside window [{earliest}, {latest}]\")\n        \n        for i in range(num_aircraft):\n            if runways[i] < 1 or runways[i] > num_runways:\n                errors.append(f\"Flight {i}: invalid runway {runways[i]}, must be between 1 and {num_runways}\")\n        \n        for i in range(num_aircraft):\n            for j in range(num_aircraft):\n                if i != j and runways[i] == runways[j]:\n                    if landing_times[i] <= landing_times[j]:\n                        required_gap = separation_matrix[i][j]\n                        actual_gap = landing_times[j] - landing_times[i]\n                        if actual_gap < required_gap:\n                            errors.append(f\"Separation violation: flights {i} and {j} on runway {runways[i]} (gap: {actual_gap}, required: {required_gap})\")\n        \n        calculated_penalty = 0.0\n        for i in range(num_aircraft):\n            landing_time = landing_times[i]\n            target = flights[i][TARGET]\n            if landing_time < target:\n                calculated_penalty += (target - landing_time) * flights[i][EARLY_PENALTY]\n            elif landing_time > target:\n                calculated_penalty += (landing_time - target) * flights[i][LATE_PENALTY]\n        \n        if abs(calculated_penalty - total_penalty) > 1e-6:\n            errors.append(f\"Penalty inconsistency: calculated {calculated_penalty}, declared {total_penalty}\")\n        \n        optimal_penalty = reference_solution[\"total_penalty\"]\n        if optimal_penalty == 0:\n            optimality_score = 1.0 if total_penalty == 0 else 0.0\n        else:\n            gap = abs(optimal_penalty - total_penalty) / abs(optimal_penalty)\n            optimality_score = max(0, 1 - gap)\n        \n        return {\n            \"is_valid\": len(errors) == 0,\n            \"validation_errors\": errors,\n            \"optimality_score\": optimality_score\n        }\n        \n    except Exception as e:\n        return {\"is_valid\": False, \"validation_errors\": [\"Format error in solution data\"], \"optimality_score\": 0.0}"
}